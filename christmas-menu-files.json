{
  "app/christmas-menu/page.tsx": "import RestaurantLayout from \"@/components/restaurant/Layout\";\nimport { FadeIn, FadeInUp, MotionLinkButton } from \"@/components/animations/MotionWrappers\";\nimport { getSEOTags, renderSchemaTags } from \"@/libs/seo\";\nimport { SchemaInjector } from \"@/components/seo/RestaurantSchema\";\nimport Link from \"@/lib/debugLink\";\nimport { getContactInfo } from \"@/lib/restaurantData\";\nimport ChristmasMusicPlayer from \"./_components/ChristmasMusicPlayer\";\n\nexport const metadata = getSEOTags({\n  title: \"Christmas Menu 2025 | Old Crown Girton ‚Äì Festive Dining in Cambridge\",\n  description:\n    \"Enjoy Old Crown Girton's 2025 Christmas menu. Pick a starter, main, side and dessert, with mulled wine or another drink of their choice included. Chef's set menu costs ¬£44.99 per guest.\",\n  keywords: [\n    \"Cambridge Christmas menu\",\n    \"Christmas menu\",\n    \"Old Crown Girton Christmas\",\n    \"Girton festive dining\",\n    \"best Christmas menu 2025\",\n    \"Christmas dining Cambridge\",\n    \"festive menu Girton\",\n  ],\n  canonicalUrlRelative: \"/christmas-menu\",\n  openGraph: {\n    title: \"Old Crown Girton Christmas Menu 2025 ‚Äì Reserve Your Festive Table\",\n    description:\n      \"Celebrate in Cambridge with the Old Crown Girton Christmas menu. Choose your courses or book the chef's set menu with mulled wine or another drink of their choice included for ¬£44.99 per guest.\",\n    url: \"https://oldcrowngirton.com/christmas-menu\",\n  },\n});\n\nconst CHRISTMAS_MENU_PDF_PATH = \"/documents/old-crown-girton-christmas-menu.pdf\";\nconst CHRISTMAS_MENU_PDF_FILENAME = \"old-crown-girton-christmas-menu.pdf\";\n\nconst slugify = (value: string) =>\n  value\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, \"-\")\n    .replace(/(^-|-$)/g, \"\");\n\ntype MenuItemData = {\n  id: string;\n  name: string;\n  description: string;\n};\n\ntype MenuSectionData = {\n  id: string;\n  name: string;\n  description?: string;\n  items: MenuItemData[];\n};\n\ntype FestiveMenu = {\n  title: string;\n  description: string;\n  sections: MenuSectionData[];\n  footer: {\n    experience: string;\n    location: string;\n    contactLabel: string;\n    contactWebsite: string;\n    contactPhone: string;\n    notes: string;\n  };\n};\n\ntype ChefSelections = {\n  title: string;\n  description: string;\n  items: MenuItemData[];\n  drink: {\n    offer: string;\n    included: boolean;\n  };\n  price: {\n    value: string;\n  };\n};\n\nconst FULL_CHRISTMAS_MENU: FestiveMenu = {\n  title: \"Choose Your Christmas Meal\",\n  description:\n    \"Pick one dish from each section. Every guest receives mulled wine or another drink of their choice.\",\n  sections: [\n    {\n      id: slugify(\"Starters\"),\n      name: \"Starters\",\n      items: [\n        {\n          id: slugify(\"Sha Phaley Delight\"),\n          name: \"Sha Phaley Delight\",\n          description:\n            \"Crispy fried pastry filled with minced meat, egg and cheese. Served with tomato chutney.\",\n        },\n        {\n          id: slugify(\"Turkey's Nepalese Christmas Choyela\"),\n          name: \"Turkey's Nepalese Christmas Choyela\",\n          description:\n            \"Roasted turkey mixed with Nepali spices, mustard oil and fresh herbs.\",\n        },\n        {\n          id: slugify(\"Tandoori Broccoli\"),\n          name: \"Tandoori Broccoli\",\n          description:\n            \"Grilled broccoli in spiced yogurt with mint sauce and tamarind chutney.\",\n        },\n        {\n          id: slugify(\"Banana Dumpling\"),\n          name: \"Banana Dumpling\",\n          description:\n            \"Warm dumpling with a sweet banana filling.\",\n        },\n      ],\n    },\n    {\n      id: slugify(\"Mains\"),\n      name: \"Mains\",\n      items: [\n        {\n          id: slugify(\"Zesty Lemon Sea Bass & Creamy Mash\"),\n          name: \"Zesty Lemon Sea Bass & Creamy Mash\",\n          description:\n            \"Tender grilled sea bass infused with fresh lemon zest and herbs, served alongside smooth, buttery mashed potatoes.\",\n        },\n        {\n          id: slugify(\"Chicken Pistachio Korma\"),\n          name: \"Chicken Pistachio Korma\",\n          description:\n            \"Chicken tikka simmered in a creamy pistachio sauce.\",\n        },\n        {\n          id: slugify(\"Himalayan Christmas Sizzler\"),\n          name: \"Himalayan Christmas Sizzler\",\n          description:\n            \"Turkey breast served sizzling in wine and cream sauce with a hint of oyster and bright vegetables.\",\n        },\n        {\n          id: slugify(\"Santa's Vegetarian Feast\"),\n          name: \"Santa's Vegetarian Feast\",\n          description:\n            \"Baby corn, potatoes, mushrooms, kidney beans and carrots cooked with butter and herbs.\",\n        },\n      ],\n    },\n    {\n      id: slugify(\"Sides\"),\n      name: \"Sides\",\n      items: [\n        {\n          id: slugify(\"Fragrant Pilau Rice\"),\n          name: \"Fragrant Pilau Rice\",\n          description: \"Basmati rice cooked with gentle spices and ghee.\",\n        },\n        {\n          id: slugify(\"Mini Festive Naan\"),\n          name: \"Mini Festive Naan\",\n          description: \"Soft naan bread baked fresh for the table.\",\n        },\n      ],\n    },\n    {\n      id: slugify(\"Desserts\"),\n      name: \"Desserts\",\n      items: [\n        {\n          id: slugify(\"Classic Christmas Pudding\"),\n          name: \"Classic Christmas Pudding\",\n          description: \"Rich spiced pudding served warm.\",\n        },\n        {\n          id: slugify(\"Nepalese Spiced Rice Pudding\"),\n          name: \"Nepalese Spiced Rice Pudding\",\n          description:\n            \"Creamy rice pudding with light Nepalese spices.\",\n        },\n        {\n          id: slugify(\"Vegan Rhubarb & Ginger Bravos\"),\n          name: \"Vegan Rhubarb & Ginger Bravos\",\n          description:\n            \"Tangy rhubarb dessert with ginger, fully plant-based.\",\n        },\n      ],\n    },\n  ],\n  footer: {\n    experience: \"Celebrate Christmas at The Old Crown in Girton.\",\n    location: \"89 High St, Girton, Cambridge CB3 0QD\",\n    contactLabel: \"oldcrowngirton.com\",\n    contactWebsite: \"https://oldcrowngirton.com\",\n    contactPhone: \"01223 277217\",\n    notes:\n      \"Our regular menu stays available alongside these dishes. Items may change if ingredients run out.\",\n  },\n};\n\nconst CHEF_SELECTIONS: ChefSelections = {\n  title: \"Chef's Christmas Selections\",\n  description:\n    \"Enjoy a set menu chosen by our chefs with four courses and mulled wine or another drink of their choice included.\",\n  items: [\n    {\n      id: slugify(\"Turkey's Nepalese Christmas Choyela\"),\n      name: \"Turkey's Nepalese Christmas Choyela\",\n      description:\n        \"Roasted turkey tossed with Nepali spices, mustard oil and fresh herbs.\",\n    },\n    {\n      id: slugify(\"Himalayan Christmas Sizzler\"),\n      name: \"Himalayan Christmas Sizzler\",\n      description:\n        \"Turkey breast served sizzling with wine and cream sauce, a hint of oyster and bright vegetables.\",\n    },\n    {\n      id: slugify(\"Fragrant Pilau Rice\"),\n      name: \"Fragrant Pilau Rice\",\n      description: \"Basmati rice cooked with gentle spices and ghee.\",\n    },\n    {\n      id: slugify(\"Nepalese Spiced Rice Pudding\"),\n      name: \"Nepalese Spiced Rice Pudding\",\n      description:\n        \"Creamy rice pudding with gentle spice to finish the meal.\",\n    },\n  ],\n  drink: {\n    offer:\n      \"Enjoy a glass of mulled wine or choose another drink when you arrive.\",\n    included: true,\n  },\n  price: {\n    value: \"44.99\",\n  },\n};\n\nconst highlightCards = [\n  {\n    icon: \"üéÑ\",\n    title: \"A cosy Cambridge Christmas\",\n    body: \"Our dining room is dressed with trees, lights and a glowing fire so it feels warm the moment you walk in.\",\n  },\n  {\n    icon: \"üçΩÔ∏è\",\n    title: \"Comfort food with spice\",\n    body: \"Classic British comfort dishes sit beside bold Nepalese flavours so everyone finds something they love.\",\n  },\n  {\n    icon: \"ü•Ç\",\n    title: \"Toasts made easy\",\n    body: \"Start with mulled wine or another drink of their choice, and let our bar team keep the glasses full all night.\",\n  },\n  {\n    icon: \"üë®‚Äçüë©‚Äçüëß\",\n    title: \"Space for every group\",\n    body: \"Bring family, friends or work mates‚Äîwe can seat small tables or large gatherings with ease.\",\n  },\n] as const;\n\nconst assurancePoints = [\n  {\n    icon: \"‚úÖ\",\n    title: \"Dietary friendly\",\n    description: \"Tell us about allergies or preferences and we will offer safe swaps without fuss.\",\n  },\n  {\n    icon: \"üìû\",\n    title: \"Friendly planning support\",\n    description: \"Call or email and we will help with bookings, deposits and timings.\",\n  },\n  {\n    icon: \"üéÅ\",\n    title: \"Ready for parties\",\n    description: \"Need a private room or team celebration? We can set up the space, music and menu.\",\n  },\n] as const;\n\nexport default async function ChristmasMenuPage() {\n  const contact = getContactInfo();\n  const telHref = contact.phone.primary.replace(/\\s+/g, \"\");\n  const phoneDisplay = contact.phone.display.replace(/\\s+/g, \"\\u00a0\");\n\n  const structuredData = [\n    {\n      \"@context\": \"https://schema.org\",\n      \"@type\": \"Menu\",\n      name: \"Old Crown Girton Christmas Menu 2025\",\n      description: FULL_CHRISTMAS_MENU.description,\n      url: \"https://oldcrowngirton.com/christmas-menu\",\n      hasMenuSection: [\n        ...FULL_CHRISTMAS_MENU.sections.map((section) => ({\n          \"@type\": \"MenuSection\",\n          name: section.name,\n          description: section.description,\n          hasMenuItem: section.items.map((item) => ({\n            \"@type\": \"MenuItem\",\n            name: item.name,\n            description: item.description,\n            offers: {\n              \"@type\": \"Offer\",\n              availability: \"https://schema.org/InStoreOnly\",\n            },\n          })),\n        })),\n        {\n          \"@type\": \"MenuSection\",\n          name: CHEF_SELECTIONS.title,\n          description: CHEF_SELECTIONS.description,\n          hasMenuItem: [\n            ...CHEF_SELECTIONS.items.map((item) => ({\n              \"@type\": \"MenuItem\",\n              name: item.name,\n              description: item.description,\n              offers: {\n                \"@type\": \"Offer\",\n                availability: \"https://schema.org/InStoreOnly\",\n              },\n            })),\n            {\n              \"@type\": \"MenuItem\",\n              name: \"Festive drink on arrival\",\n              description: CHEF_SELECTIONS.drink.offer,\n              offers: {\n                \"@type\": \"Offer\",\n                availability: \"https://schema.org/InStoreOnly\",\n              },\n            },\n          ],\n        },\n      ],\n      offers: [\n        {\n          \"@type\": \"Offer\",\n          price: CHEF_SELECTIONS.price.value,\n          priceCurrency: \"GBP\",\n          description: \"Chef's Christmas Selections per person with mulled wine or another drink of their choice included.\",\n          availability: \"https://schema.org/InStoreOnly\",\n          url: \"https://oldcrowngirton.com/christmas-menu\",\n        },\n      ],\n      provider: {\n        \"@type\": \"Restaurant\",\n        name: \"The Old Crown Girton\",\n        telephone: contact.phone.primary,\n        email: contact.email.primary,\n        address: {\n          \"@type\": \"PostalAddress\",\n          streetAddress: contact.address.street,\n          addressLocality: contact.address.city,\n          postalCode: contact.address.postcode,\n          addressCountry: \"GB\",\n        },\n      },\n    },\n  ];\n\n  return (\n    <>\n      <style\n        dangerouslySetInnerHTML={{\n          __html:\n            \"@media (prefers-reduced-motion: reduce) {*,*::before,*::after{animation:none!important;transition:none!important;scroll-behavior:auto!important} html:focus-within{scroll-behavior:auto!important}}\",\n        }}\n      />\n      <RestaurantLayout>\n        {renderSchemaTags(structuredData)}\n        <SchemaInjector\n          type=\"breadcrumb\"\n          data={[\n            { name: \"Home\", url: \"https://oldcrowngirton.com/\" },\n            { name: \"Christmas Menu\", url: \"https://oldcrowngirton.com/christmas-menu\" },\n          ]}\n          page=\"christmas-menu\"\n        />\n\n        <section\n          className=\"relative bg-gradient-to-br from-brand-700 via-crimson-600 to-cardamom-700 text-white py-16 md:py-24\"\n          aria-labelledby=\"christmas-hero-heading\"\n        >\n          <div className=\"absolute inset-0 bg-black/20\" aria-hidden=\"true\"></div>\n          <div className=\"relative max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 text-center space-y-6\">\n            <FadeIn>\n              <div className=\"inline-flex items-center gap-2 px-4 py-2 bg-white/10 border border-white/30 rounded-full backdrop-blur\">\n                <span aria-hidden=\"true\" role=\"img\">üéÑ</span>\n                <span className=\"text-sm font-semibold tracking-wide uppercase\">Festive Menu 2025</span>\n                <span className=\"sr-only\">Christmas menu now available</span>\n              </div>\n            </FadeIn>\n            <FadeInUp>\n              <h1 id=\"christmas-hero-heading\" className=\"text-3xl md:text-5xl font-display font-bold leading-tight\">\n                Christmas Menu 2025 at Old Crown Girton\n              </h1>\n            </FadeInUp>\n            <FadeInUp>\n              <p className=\"text-lg md:text-xl text-neutral-100 max-w-3xl mx-auto leading-relaxed\">\n                Join us for a warm festive meal in Girton. Pick your favourites from each course and enjoy mulled wine or another drink of their choice the moment you arrive.\n              </p>\n            </FadeInUp>\n            <FadeInUp>\n              <div\n                className=\"flex flex-wrap justify-center gap-3 text-base font-semibold\"\n                role=\"list\"\n                aria-label=\"Festive inclusions\"\n              >\n                <span\n                  className=\"inline-flex items-center gap-2 rounded-full border border-accent-200 bg-accent-500 px-4 py-2 text-neutral-900 shadow-sm\"\n                  role=\"listitem\"\n                >\n                  <span aria-hidden=\"true\" role=\"img\">\n                    üç∑\n                  </span>\n                  Mulled wine or another drink of their choice included\n                </span>\n                <span\n                  className=\"inline-flex items-center gap-2 rounded-full border border-white/40 bg-white/15 px-4 py-2 text-white shadow-sm backdrop-blur\"\n                  role=\"listitem\"\n                >\n                  <span aria-hidden=\"true\" role=\"img\">\n                    üí∑\n                  </span>\n                  Chef&rsquo;s set menu &pound;44.99&nbsp;per&nbsp;guest\n                </span>\n              </div>\n            </FadeInUp>\n            <FadeInUp>\n              <div className=\"flex flex-col sm:flex-row sm:flex-wrap justify-center gap-4\">\n                <MotionLinkButton\n                  href={CHRISTMAS_MENU_PDF_PATH}\n                  download={CHRISTMAS_MENU_PDF_FILENAME}\n                  className=\"inline-flex items-center justify-center gap-2 px-6 py-3 rounded-lg bg-white text-brand-800 font-semibold shadow-lg hover:bg-brand-100 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-brand-300 focus-visible:ring-offset-brand-700\"\n                  ariaLabel=\"Download the Christmas menu\"\n                >\n                  <span aria-hidden=\"true\" role=\"img\">‚¨áÔ∏è</span>\n                  Download Christmas Menu\n                </MotionLinkButton>\n                <MotionLinkButton\n                  href=\"https://togo.uk.com/makebookingv2.aspx?venueid=2640&nv=true\"\n                  className=\"inline-flex items-center justify-center gap-2 px-6 py-3 rounded-lg bg-white text-brand-800 font-semibold shadow-lg hover:bg-brand-100 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-brand-300 focus-visible:ring-offset-brand-700\"\n                  ariaLabel=\"Book your table online\"\n                >\n                  <span aria-hidden=\"true\" role=\"img\">üóìÔ∏è</span>\n                  Book Your Table Online\n                </MotionLinkButton>\n                <MotionLinkButton\n                  href={`tel:${telHref}`}\n                  className=\"inline-flex items-center justify-center gap-2 px-6 py-3 rounded-lg bg-accent-500 text-neutral-900 font-semibold shadow-lg hover:bg-accent-400 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-accent-200 focus-visible:ring-offset-brand-700\"\n                  ariaLabel=\"Book your table via call\"\n                >\n                  <span aria-hidden=\"true\" role=\"img\">üìû</span>\n                  Book Your Table via Call\n                </MotionLinkButton>\n              </div>\n            </FadeInUp>\n            <FadeInUp>\n              <div className=\"flex justify-center\">\n                <ChristmasMusicPlayer />\n              </div>\n            </FadeInUp>\n            <FadeInUp>\n              <p className=\"text-sm font-semibold uppercase tracking-wide text-white/90\">\n                Seats are limited &mdash; book today.\n              </p>\n            </FadeInUp>\n            <FadeIn>\n              <div className=\"flex flex-wrap justify-center gap-3 text-sm text-neutral-100/90\">\n                <span className=\"inline-flex items-center gap-2 px-3 py-1.5 bg-white/10 rounded-full border border-white/20\">\n                  <span aria-hidden=\"true\" role=\"img\">üìç</span>\n                  Girton, Cambridge\n                </span>\n                <span className=\"inline-flex items-center gap-2 px-3 py-1.5 bg-white/10 rounded-full border border-white/20\">\n                  <span aria-hidden=\"true\" role=\"img\">üéâ</span>\n                  Festive lunches &amp; dinners\n                </span>\n                <span className=\"inline-flex items-center gap-2 px-3 py-1.5 bg-white/10 rounded-full border border-white/20\">\n                  <span aria-hidden=\"true\" role=\"img\">‚ú®</span>\n                  Mulled wine or another drink of their choice included\n                </span>\n              </div>\n            </FadeIn>\n          </div>\n        </section>\n\n        <section className=\"bg-neutral-50 py-16 md:py-20\" aria-labelledby=\"full-christmas-menu-heading\">\n          <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8\">\n            <FadeIn>\n              <div className=\"max-w-3xl mx-auto text-center space-y-4\">\n                <h2 id=\"full-christmas-menu-heading\" className=\"text-3xl md:text-4xl font-display font-bold text-brand-800\">\n                  {FULL_CHRISTMAS_MENU.title}\n                </h2>\n                <p className=\"text-lg text-brand-600 leading-relaxed\">\n                  {FULL_CHRISTMAS_MENU.description}\n                </p>\n              </div>\n            </FadeIn>\n            <FadeInUp>\n              <div className=\"mt-12 grid gap-8 md:grid-cols-2 xl:grid-cols-4\">\n                {FULL_CHRISTMAS_MENU.sections.map((section) => (\n                  <article\n                    key={section.id}\n                    className=\"flex h-full flex-col rounded-2xl border border-brand-100 bg-white/80 p-6 shadow-lg\"\n                    aria-labelledby={`section-${section.id}-title`}\n                  >\n                    <header className=\"mb-4\">\n                      <h3\n                        id={`section-${section.id}-title`}\n                        className=\"text-xl font-semibold text-brand-700\"\n                      >\n                        {section.name}\n                      </h3>\n                      {section.description && (\n                        <p className=\"mt-1 text-brand-600 leading-relaxed\">{section.description}</p>\n                      )}\n                    </header>\n                    <ul className=\"space-y-4\" role=\"list\" aria-label={`${section.name} options`}>\n                      {section.items.map((item) => (\n                        <li\n                          key={item.id}\n                          className=\"rounded-lg border border-neutral-200 bg-neutral-50/80 p-4\"\n                        >\n                          <h4 className=\"text-base font-semibold text-brand-800 leading-tight\">\n                            {item.name}\n                          </h4>\n                          <p className=\"mt-1 text-sm text-brand-600 leading-relaxed\">\n                            {item.description}\n                          </p>\n                        </li>\n                      ))}\n                    </ul>\n                  </article>\n                ))}\n              </div>\n            </FadeInUp>\n            <FadeIn>\n              <div className=\"mt-12 rounded-2xl border border-brand-100 bg-brand-50/70 p-8 shadow-md\">\n                <h3 className=\"text-lg font-semibold text-brand-800 mb-4\">Good to know</h3>\n                <dl className=\"grid gap-6 sm:grid-cols-2\">\n                  <div>\n                    <dt className=\"text-sm font-semibold uppercase tracking-wide text-brand-600\">Experience</dt>\n                    <dd className=\"text-brand-700 leading-relaxed\">{FULL_CHRISTMAS_MENU.footer.experience}</dd>\n                  </div>\n                  <div>\n                    <dt className=\"text-sm font-semibold uppercase tracking-wide text-brand-600\">Location</dt>\n                    <dd className=\"text-brand-700 leading-relaxed\">\n                      <address className=\"not-italic\">\n                        {FULL_CHRISTMAS_MENU.footer.location}\n                      </address>\n                      <Link\n                        href={contact.address.google_maps_url}\n                        className=\"mt-2 inline-flex items-center gap-2 text-sm font-semibold text-brand-700 underline\"\n                      >\n                        Open in Maps\n                      </Link>\n                    </dd>\n                  </div>\n                  <div>\n                    <dt className=\"text-sm font-semibold uppercase tracking-wide text-brand-600\">Contact</dt>\n                    <dd className=\"text-brand-700 leading-relaxed\">\n                      <div className=\"flex flex-wrap items-center gap-2\">\n                        <Link href={FULL_CHRISTMAS_MENU.footer.contactWebsite} className=\"font-semibold underline\">\n                          {FULL_CHRISTMAS_MENU.footer.contactLabel}\n                        </Link>\n                        <span aria-hidden=\"true\" className=\"text-brand-500\">‚Ä¢</span>\n                        <Link href={`tel:${telHref}`} className=\"font-semibold underline\">\n                          {phoneDisplay}\n                        </Link>\n                      </div>\n                    </dd>\n                  </div>\n                  <div>\n                    <dt className=\"text-sm font-semibold uppercase tracking-wide text-brand-600\">Notes</dt>\n                    <dd className=\"text-brand-700 leading-relaxed\">\n                      {FULL_CHRISTMAS_MENU.footer.notes}\n                    </dd>\n                  </div>\n                </dl>\n              </div>\n            </FadeIn>\n          </div>\n        </section>\n\n        <section className=\"bg-white py-16 md:py-20\" aria-labelledby=\"chefs-christmas-heading\">\n          <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8\">\n            <FadeIn>\n              <div className=\"max-w-3xl space-y-4\">\n                <h2 id=\"chefs-christmas-heading\" className=\"text-3xl md:text-4xl font-display font-bold text-brand-800\">\n                  Chef&rsquo;s Christmas Selections\n                </h2>\n                <p className=\"text-lg text-brand-600 leading-relaxed\">\n                  {CHEF_SELECTIONS.description}\n                </p>\n              </div>\n            </FadeIn>\n            <div className=\"mt-10 grid gap-8 lg:grid-cols-[2fr,1fr]\">\n              <FadeInUp>\n                <ul className=\"space-y-4\" role=\"list\" aria-label=\"Chef&rsquo;s selection dishes\">\n                  {CHEF_SELECTIONS.items.map((item) => (\n                    <li\n                      key={item.id}\n                      className=\"rounded-2xl border border-brand-100 bg-neutral-50/80 p-6 shadow-sm\"\n                    >\n                      <h3 className=\"text-lg font-semibold text-brand-800 leading-tight\">{item.name}</h3>\n                      <p className=\"mt-2 text-brand-600 leading-relaxed\">{item.description}</p>\n                    </li>\n                  ))}\n                </ul>\n              </FadeInUp>\n              <FadeInUp>\n                <aside className=\"rounded-2xl border border-brand-100 bg-brand-50/80 p-8 shadow-lg\">\n                  <p className=\"text-sm font-semibold uppercase tracking-wide text-brand-600\">Per person</p>\n                  <p className=\"mt-2 text-3xl font-display font-bold text-brand-800\">\n                    &pound;{CHEF_SELECTIONS.price.value}\n                  </p>\n                  <p className=\"mt-4 text-brand-700 leading-relaxed\">\n                  {CHEF_SELECTIONS.drink.offer}\n                </p>\n                {CHEF_SELECTIONS.drink.included && (\n                  <p className=\"mt-4 inline-flex items-center gap-2 rounded-full border border-accent-200 bg-accent-500 px-3 py-1 text-sm font-semibold text-neutral-900\">\n                    <span aria-hidden=\"true\" role=\"img\">üç∑</span>\n                    Mulled wine or another drink of their choice comes with every menu\n                  </p>\n                )}\n                <div className=\"mt-6 space-y-3\">\n                  <MotionLinkButton\n                    href=\"https://togo.uk.com/makebookingv2.aspx?venueid=2640&nv=true\"\n                    className=\"inline-flex w-full items-center justify-center gap-2 rounded-lg bg-brand-700 px-5 py-3 text-white hover:bg-brand-800 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-brand-300 focus-visible:ring-offset-brand-50\"\n                    ariaLabel=\"Book the Chef&rsquo;s Christmas set menu online\"\n                  >\n                    <span aria-hidden=\"true\" role=\"img\">ü•Ç</span>\n                    Book the festive set menu\n                  </MotionLinkButton>\n                    <Link\n                      href={`tel:${telHref}`}\n                      className=\"inline-flex w-full items-center justify-center gap-2 rounded-lg border border-brand-200 px-5 py-3 text-brand-700 hover:bg-brand-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-brand-300\"\n                    >\n                      <span aria-hidden=\"true\" role=\"img\">‚òéÔ∏è</span>\n                      Call our team\n                    </Link>\n                  </div>\n                </aside>\n              </FadeInUp>\n            </div>\n          </div>\n        </section>\n\n        <section className=\"bg-white py-16 md:py-20\" aria-labelledby=\"festive-highlights-heading\">\n          <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8\">\n            <FadeIn>\n              <div className=\"max-w-3xl mx-auto text-center space-y-4\">\n                <h2 id=\"festive-highlights-heading\" className=\"text-3xl md:text-4xl font-display font-bold text-brand-800\">\n                  Why guests love our Christmas menu\n                </h2>\n                <p className=\"text-lg text-brand-600 leading-relaxed\">\n                  We mix easy-going Old Crown hospitality with bold Nepalese flavour so your festive meal feels relaxed and special.\n                </p>\n              </div>\n            </FadeIn>\n            <FadeInUp>\n              <div className=\"mt-12 grid gap-8 sm:grid-cols-2\">\n                {highlightCards.map((card) => (\n                  <article\n                    key={card.title}\n                    className=\"h-full rounded-2xl border border-brand-100 bg-neutral-50 p-8 shadow-lg transition-transform duration-300 hover:-translate-y-1 hover:shadow-2xl focus-within:shadow-2xl\"\n                  >\n                    <div className=\"mb-4 inline-flex h-12 w-12 items-center justify-center rounded-full bg-accent-100 text-2xl\" aria-hidden=\"true\">\n                      {card.icon}\n                    </div>\n                    <h3 className=\"text-xl font-semibold text-brand-700 mb-3\">{card.title}</h3>\n                    <p className=\"text-brand-600 leading-relaxed\">{card.body}</p>\n                  </article>\n                ))}\n              </div>\n            </FadeInUp>\n          </div>\n        </section>\n\n        <section className=\"bg-white py-16 md:py-20\" aria-labelledby=\"festive-support-heading\">\n          <div className=\"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8\">\n            <FadeIn>\n              <div className=\"grid gap-10 lg:grid-cols-2\">\n                <div className=\"space-y-6\">\n                  <h2 id=\"festive-support-heading\" className=\"text-3xl md:text-4xl font-display font-bold text-brand-800\">\n                    Plan your visit with us\n                  </h2>\n                  <p className=\"text-lg text-brand-600 leading-relaxed\">\n                    Tell us about your guests, timings and any needs. We will reserve the right space, handle deposits and keep everything running smoothly.\n                  </p>\n                  <div className=\"flex flex-col gap-4\">\n                    <Link\n                      href={`mailto:${contact.email.bookings}`}\n                      className=\"inline-flex items-center gap-3 rounded-lg bg-brand-700 px-5 py-3 text-white shadow-lg transition hover:bg-brand-800 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-brand-300\"\n                    >\n                      <span aria-hidden=\"true\" role=\"img\">üìß</span>\n                      Email the festive team\n                    </Link>\n                    <Link\n                      href={contact.address.google_maps_url}\n                      className=\"inline-flex items-center gap-3 rounded-lg border border-brand-200 px-5 py-3 text-brand-700 hover:bg-brand-50 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-brand-300\"\n                    >\n                      <span aria-hidden=\"true\" role=\"img\">üìç</span>\n                      Visit Old Crown Girton\n                    </Link>\n                  </div>\n                  <p className=\"text-sm text-brand-500 leading-relaxed\">\n                    Prefer a call? Ring us on <a className=\"font-semibold underline\" href={`tel:${telHref}`}>{phoneDisplay}</a> and ask for the Christmas team.\n                  </p>\n                </div>\n                <div className=\"space-y-5\">\n                  {assurancePoints.map((point) => (\n                    <div\n                      key={point.title}\n                      className=\"rounded-xl border border-brand-100 bg-brand-50/60 p-6 shadow-md\"\n                    >\n                      <div className=\"mb-3 inline-flex h-10 w-10 items-center justify-center rounded-full bg-white text-2xl\" aria-hidden=\"true\">\n                        {point.icon}\n                      </div>\n                      <h3 className=\"text-lg font-semibold text-brand-700\">{point.title}</h3>\n                      <p className=\"text-brand-600 leading-relaxed\">{point.description}</p>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </FadeIn>\n          </div>\n        </section>\n      </RestaurantLayout>\n    </>\n  );\n}\n",
  "app/christmas-menu/_components/ChristmasMusicPlayer.tsx": "\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\n\nconst AUDIO_SRC = \"/audio/Jingle-Bells-3(chosic.com).mp3\";\n\n/**\n * Lightweight festive music controller with accessible play/pause toggle.\n * Attempts a single polite autoplay; falls back to manual control when blocked.\n */\nexport default function ChristmasMusicPlayer() {\n  const audioRef = useRef<HTMLAudioElement | null>(null);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [autoplayBlocked, setAutoplayBlocked] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (typeof window === \"undefined\") {\n      return;\n    }\n\n    const audio = new Audio(AUDIO_SRC);\n    audio.loop = true;\n    audio.autoplay = true;\n    audio.preload = \"auto\";\n    audio.volume = 0.35;\n    audioRef.current = audio;\n\n    const handlePlay = () => setIsPlaying(true);\n    const handlePause = () => setIsPlaying(false);\n    const handleError = () => setError(\"Festive music is unavailable right now.\");\n\n    audio.addEventListener(\"play\", handlePlay);\n    audio.addEventListener(\"pause\", handlePause);\n    audio.addEventListener(\"error\", handleError);\n\n    const handleVisibility = () => {\n      if (document.hidden && !audio.paused) {\n        audio.pause();\n      }\n    };\n\n    document.addEventListener(\"visibilitychange\", handleVisibility);\n\n    audio\n      .play()\n      .then(() => {\n        setAutoplayBlocked(false);\n        setError(null);\n      })\n      .catch(() => {\n        setAutoplayBlocked(true);\n        audio.pause();\n      });\n\n    return () => {\n      document.removeEventListener(\"visibilitychange\", handleVisibility);\n      audio.removeEventListener(\"play\", handlePlay);\n      audio.removeEventListener(\"pause\", handlePause);\n      audio.removeEventListener(\"error\", handleError);\n      audio.pause();\n      audioRef.current = null;\n    };\n  }, []);\n\n  const togglePlayback = async () => {\n    const audio = audioRef.current;\n    if (!audio) {\n      setError(\"Festive music is still loading. Please try again.\");\n      return;\n    }\n\n    if (audio.paused) {\n      try {\n        await audio.play();\n        setAutoplayBlocked(false);\n        setError(null);\n      } catch {\n        setError(\"Your browser blocked playback‚Äîplease allow audio and try again.\");\n      }\n    } else {\n      audio.pause();\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col items-center gap-2 text-white\">\n      <button\n        type=\"button\"\n        onClick={togglePlayback}\n        className=\"inline-flex items-center gap-2 rounded-full border border-white/40 bg-white/10 px-4 py-2 text-sm font-semibold shadow-sm transition hover:bg-white/20 focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-accent-200 focus-visible:ring-offset-brand-700\"\n        aria-pressed={isPlaying}\n      >\n        <span aria-hidden=\"true\" role=\"img\">\n          {isPlaying ? \"‚è∏Ô∏è\" : \"üé∂\"}\n        </span>\n        {isPlaying ? \"Pause Christmas music\" : \"Play Christmas music\"}\n      </button>\n      <p className=\"text-xs text-white/80\" aria-live=\"polite\">\n        {error\n          ? error\n          : autoplayBlocked && !isPlaying\n            ? \"Press play to hear the Christmas music.\"\n            : isPlaying\n              ? \"Christmas music is playing.\"\n              : \"Starting music...\"}\n      </p>\n      <p className=\"text-[11px] text-white/60\">\n        Track: ‚ÄúJingle Bells‚Äù by Kevin MacLeod (CC BY 3.0) via{\" \"}\n        <a\n          href=\"https://www.chosic.com/free-music/all/\"\n          className=\"underline text-white/80 hover:text-white\"\n        >\n          Chosic\n        </a>\n      </p>\n    </div>\n  );\n}\n",
  "components/restaurant/Layout.tsx": "import { ReactNode } from 'react';\nimport dynamic from 'next/dynamic';\n// Critical above-fold components should NOT be dynamic\nimport NavbarStatic from './NavbarStatic';\nimport Footer from './Footer';\nimport Navbar from './Navbar';\n\nconst NAVBAR_OFFSET_FALLBACK = '64px';\nconst NAVBAR_STACK_OFFSET_FALLBACK = '104px';\n\ninterface LayoutProps {\n  children: ReactNode;\n  noMotion?: boolean;\n}\n\nexport default async function RestaurantLayout({ children, noMotion = false }: LayoutProps) {\n  return (\n    <div className=\"min-h-screen bg-neutral\">\n      {noMotion ? <NavbarStatic /> : <Navbar />}\n      <main\n        className=\"overflow-x-hidden relative\"\n        id=\"main-content\"\n        tabIndex={-1}\n        style={{\n          minHeight: `calc(100vh - var(--navbar-offset, ${NAVBAR_OFFSET_FALLBACK}))`, // Base navbar height (excludes promo banner)\n          isolation: 'isolate', // Create new stacking context\n          paddingTop: `var(--navbar-stack-offset, ${NAVBAR_STACK_OFFSET_FALLBACK})`, // Allow space for navbar + seasonal banner stack\n        }}\n      >\n        {children}\n      </main>\n      <Footer />\n    </div>\n  );\n}\n",
  "components/restaurant/Navbar.tsx": "\"use client\";\n\nimport { useLayoutEffect, useRef, useState } from 'react';\nimport { ContactCTA, NavLinks, NavbarLogo, useNavContent } from './NavbarParts';\nimport SeasonalPromoBanner from './SeasonalPromoBanner';\n\nconst MOBILE_NAV_ID = 'mobile-nav';\nconst SEASONAL_BANNER_SELECTOR = '[data-seasonal-banner]';\n\nexport default function Navbar() {\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\n  const navRef = useRef<HTMLElement | null>(null);\n  const {\n    links,\n    error,\n    errorLabel,\n    contactLabel,\n    navLabel,\n    menuButtonOpenLabel,\n    menuButtonCloseLabel,\n    logoAlt,\n  } = useNavContent();\n\n  const toggleMenu = () => setIsMenuOpen((prev) => !prev);\n  const closeMenu = () => setIsMenuOpen(false);\n\n  useLayoutEffect(() => {\n    if (typeof window === 'undefined') return undefined;\n    const element = navRef.current;\n    if (!element) return undefined;\n\n    const updateOffsets = () => {\n      const navRect = element.getBoundingClientRect();\n      const bannerEl = element.querySelector(SEASONAL_BANNER_SELECTOR) as HTMLElement | null;\n      const bannerHeight = bannerEl ? bannerEl.getBoundingClientRect().height : 0;\n      const baseHeight = Math.max(navRect.height - bannerHeight, 0);\n\n      document.documentElement.style.setProperty('--navbar-offset', `${baseHeight}px`);\n      document.documentElement.style.setProperty('--navbar-stack-offset', `${navRect.height}px`);\n    };\n\n    const rafUpdate = () => window.requestAnimationFrame(updateOffsets);\n\n    updateOffsets();\n\n    const resizeObserver =\n      typeof ResizeObserver !== 'undefined'\n        ? new ResizeObserver(() => {\n            rafUpdate();\n          })\n        : null;\n\n    if (resizeObserver) {\n      resizeObserver.observe(element);\n      const bannerEl = element.querySelector(SEASONAL_BANNER_SELECTOR) as HTMLElement | null;\n      if (bannerEl) {\n        resizeObserver.observe(bannerEl);\n      }\n    }\n\n    window.addEventListener('resize', rafUpdate);\n\n    return () => {\n      if (resizeObserver) {\n        resizeObserver.disconnect();\n      }\n      window.removeEventListener('resize', rafUpdate);\n      document.documentElement.style.removeProperty('--navbar-offset');\n      document.documentElement.style.removeProperty('--navbar-stack-offset');\n    };\n  }, []);\n\n  return (\n    <nav\n      ref={navRef}\n      aria-label={navLabel}\n      className=\"fixed inset-x-0 top-0 z-50 border-b bg-white shadow-sm\"\n    >\n      <SeasonalPromoBanner />\n      <div className=\"mx-auto w-full max-w-7xl px-4 py-2 md:px-6\">\n        <div className=\"flex items-center justify-between gap-3\">\n          <NavbarLogo altText={logoAlt} />\n\n          <div className=\"hidden flex-1 md:flex md:justify-center\">\n            <NavLinks\n              links={links}\n              error={error}\n              errorLabel={errorLabel}\n              orientation=\"horizontal\"\n            />\n          </div>\n\n          <div className=\"hidden md:flex md:flex-none\">\n            <ContactCTA label={contactLabel} />\n          </div>\n\n          <div className=\"md:hidden\">\n            <button\n              type=\"button\"\n              onClick={toggleMenu}\n              className=\"btn btn-ghost btn-square\"\n              aria-expanded={isMenuOpen}\n              aria-controls={MOBILE_NAV_ID}\n              aria-haspopup=\"menu\"\n            >\n              <span className=\"sr-only\">\n                {isMenuOpen ? menuButtonCloseLabel : menuButtonOpenLabel}\n              </span>\n              {isMenuOpen ? (\n                <svg\n                  className=\"h-6 w-6\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  viewBox=\"0 0 24 24\"\n                  aria-hidden=\"true\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M6 18L18 6M6 6l12 12\"\n                  />\n                </svg>\n              ) : (\n                <svg\n                  className=\"h-6 w-6\"\n                  fill=\"none\"\n                  stroke=\"currentColor\"\n                  viewBox=\"0 0 24 24\"\n                  aria-hidden=\"true\"\n                >\n                  <path\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                    strokeWidth={2}\n                    d=\"M4 6h16M4 12h16m-7 6h7\"\n                  />\n                </svg>\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      <div\n        id={MOBILE_NAV_ID}\n        className={`md:hidden border-t border-base-200 bg-white ${\n          isMenuOpen ? 'block' : 'hidden'\n        }`}\n      >\n        <div className=\"mx-auto w-full max-w-7xl px-4 py-3 md:px-6\">\n          <NavLinks\n            links={links}\n            error={error}\n            errorLabel={errorLabel}\n            orientation=\"vertical\"\n            onNavigate={closeMenu}\n          />\n          <div className=\"mt-3\">\n            <ContactCTA\n              label={contactLabel}\n              onClick={closeMenu}\n              fullWidth\n            />\n          </div>\n        </div>\n      </div>\n    </nav>\n  );\n}\n",
  "components/restaurant/NavbarStatic.tsx": "\"use client\";\n\nimport Navbar from './Navbar';\n\nexport default function NavbarStatic() {\n  return <Navbar />;\n}\n",
  "components/restaurant/NavbarParts.tsx": "\"use client\";\n\nimport { useMemo } from 'react';\nimport Image from 'next/image';\nimport Link from '@/lib/debugLink';\nimport { useParsedData } from '@/hooks/useParsedData';\nimport { useContent } from '@/hooks/useContent';\nimport { NavDataSchema, NavDataParsed } from '@/lib/schemas';\nimport { sanitizeHref, createHrefKey, isValidHref, logHrefIssue } from '@/utils/href';\nimport type { HrefType } from '@/utils/href';\n\nexport interface SanitizedNavLink {\n  key: string;\n  href: HrefType;\n  label: string;\n  isSeasonal: boolean;\n}\n\ninterface NavContentResult {\n  links: SanitizedNavLink[];\n  error: Error | null;\n  errorLabel: string;\n  contactLabel: string;\n  navLabel: string;\n  menuButtonOpenLabel: string;\n  menuButtonCloseLabel: string;\n  logoAlt: string;\n}\n\nexport function useNavContent(): NavContentResult {\n  const { data, error } = useParsedData<NavDataParsed>('nav.json', NavDataSchema);\n  const { data: content } = useContent();\n\n  const navLinksRaw =\n    data?.links ||\n    content?.global?.navigation?.header?.links ||\n    [];\n\n  const sanitizedLinks = useMemo<SanitizedNavLink[]>(() => {\n    return navLinksRaw.reduce<SanitizedNavLink[]>((acc, link, index) => {\n      if (!isValidHref(link.href)) {\n        logHrefIssue('Invalid href detected in navbar link', link.href, 'Navbar.useNavContent');\n        return acc;\n      }\n\n      const sanitizedHref = sanitizeHref(link.href);\n      if (sanitizedHref === '/' || sanitizedHref === '/contact') {\n        return acc;\n      }\n\n      acc.push({\n        key: createHrefKey(link.href, index),\n        href: sanitizedHref,\n        label: link.label,\n        isSeasonal: sanitizedHref === '/christmas-menu',\n      });\n      return acc;\n    }, []);\n  }, [navLinksRaw]);\n\n  const uiLabels = content?.global?.ui?.labels;\n  const ariaLabels = content?.global?.accessibility?.ariaLabels;\n  const contactLabel = content?.global?.ui?.buttons?.contact || 'Contact';\n  const navLabel = ariaLabels?.mainNavigation || 'Main navigation';\n  const menuButtonOpenLabel =\n    ariaLabels?.menuButton ||\n    ariaLabels?.openMenu ||\n    'Open navigation menu';\n  const menuButtonCloseLabel =\n    ariaLabels?.closeMenu ||\n    ariaLabels?.closeDialog ||\n    'Close navigation menu';\n  const logoAlt =\n    content?.global?.accessibility?.altTexts?.logo ||\n    'Old Crown Girton Logo';\n\n  return {\n    links: sanitizedLinks,\n    error,\n    errorLabel: uiLabels?.error || 'Nav failed',\n    contactLabel,\n    navLabel,\n    menuButtonOpenLabel,\n    menuButtonCloseLabel,\n    logoAlt,\n  };\n}\n\nexport function NavbarLogo({ altText }: { altText: string }) {\n  return (\n    <Link\n      href=\"/\"\n      className=\"flex items-center gap-2 px-2 py-1 text-brand-700\"\n    >\n      <Image\n        src=\"/images/brand/OldCrownLogo.png\"\n        alt={altText}\n        width={60}\n        height={45}\n        className=\"h-8 w-auto\"\n        priority\n      />\n      <span className=\"text-lg font-semibold text-brand-700\">\n        OLD CROWN\n      </span>\n    </Link>\n  );\n}\n\nexport function NavLinks({\n  links,\n  error,\n  errorLabel,\n  orientation = 'horizontal',\n  onNavigate,\n}: {\n  links: SanitizedNavLink[];\n  error: Error | null;\n  errorLabel: string;\n  orientation?: 'horizontal' | 'vertical';\n  onNavigate?: () => void;\n}) {\n  const isVertical = orientation === 'vertical';\n  const listClass = isVertical\n    ? 'menu menu-vertical gap-2 px-0'\n    : 'menu menu-horizontal gap-1 px-0';\n\n  const defaultLinkClass = isVertical\n    ? 'btn btn-ghost justify-start w-full text-left font-medium text-brand-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-300 focus-visible:ring-offset-2 focus-visible:ring-offset-white'\n    : 'btn btn-ghost font-semibold text-brand-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-300 focus-visible:ring-offset-2 focus-visible:ring-offset-white';\n\n  const seasonalLinkClass = isVertical\n    ? 'btn justify-start w-full text-left items-center gap-2 border-none bg-brand-50 text-brand-700 shadow-sm transition hover:bg-brand-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-400 focus-visible:ring-offset-2 focus-visible:ring-offset-white'\n    : 'btn btn-ghost items-center gap-2 font-semibold text-brand-700 hover:bg-brand-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-300 focus-visible:ring-offset-2 focus-visible:ring-offset-white';\n\n  return (\n    <div\n      className={isVertical ? 'flex flex-col gap-3' : 'flex items-center gap-3'}\n      data-orientation={orientation}\n    >\n      {error && (\n        <span className=\"badge badge-error badge-sm\">\n          {errorLabel}\n        </span>\n      )}\n      <ul className={listClass}>\n        {links.map((link) => (\n          <li key={link.key}>\n            <Link\n              href={link.href}\n              onClick={onNavigate}\n              className={link.isSeasonal ? seasonalLinkClass : defaultLinkClass}\n            >\n              {link.isSeasonal ? (\n                <>\n                  <span aria-hidden=\"true\" className=\"text-lg leading-none\">\n                    üéÑ\n                  </span>\n                  <span className=\"font-semibold\">{link.label}</span>\n                </>\n              ) : (\n                link.label\n              )}\n            </Link>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}\n\nexport function ContactCTA({\n  label,\n  onClick,\n  fullWidth = false,\n}: {\n  label: string;\n  onClick?: () => void;\n  fullWidth?: boolean;\n}) {\n  const baseClasses =\n    'btn border-none bg-brand-700 text-neutral-50 hover:bg-brand-800 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-300 focus-visible:ring-offset-2 focus-visible:ring-offset-white';\n\n  return (\n    <Link\n      href=\"/contact\"\n      onClick={onClick}\n      className={fullWidth ? `${baseClasses} btn-block` : baseClasses}\n    >\n      {label}\n    </Link>\n  );\n}\n",
  "components/restaurant/SeasonalPromoBanner.tsx": "'use client';\n\nimport Link from '@/lib/debugLink';\n\nexport default function SeasonalPromoBanner() {\n  return (\n    <div\n      className=\"border-b border-brand-100 bg-brand-50/90 backdrop-blur\"\n      data-seasonal-banner\n    >\n      <Link\n        href=\"/christmas-menu\"\n        className=\"alert mx-auto flex w-full max-w-7xl flex-col items-center justify-center gap-3 rounded-none border-none bg-transparent px-4 py-2.5 text-center text-sm text-brand-900 shadow-none transition hover:bg-brand-100/70 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand-500 focus-visible:ring-offset-2 focus-visible:ring-offset-brand-50 md:flex-row md:gap-4 md:px-6 md:py-3 md:text-base min-h-0\"\n        aria-label=\"Explore the Christmas menu and reserve your festive table\"\n      >\n        <span className=\"flex flex-wrap items-center justify-center gap-2 text-center text-brand-900\">\n          <span className=\"badge border border-brand-200 bg-brand-600 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-white\">\n            Christmas 2025\n          </span>\n          <span aria-hidden=\"true\" className=\"text-lg leading-none\">\n            üéÑ\n          </span>\n          <span className=\"font-medium\">Festive tasting menus, mulled tipples, and seasonal cheer await.</span>\n        </span>\n\n        <span className=\"flex items-center justify-center gap-2 text-center font-semibold text-brand-800\">\n          <span className=\"underline decoration-brand-300 underline-offset-4\">\n            View the Christmas menu & book your table\n          </span>\n          <svg\n            aria-hidden=\"true\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n            viewBox=\"0 0 24 24\"\n            width=\"18\"\n            height=\"18\"\n            className=\"text-brand-700\"\n          >\n            <path\n              d=\"M5 12h14m-6-6 6 6-6 6\"\n              fill=\"none\"\n              stroke=\"currentColor\"\n              strokeLinecap=\"round\"\n              strokeLinejoin=\"round\"\n              strokeWidth={2}\n            />\n          </svg>\n        </span>\n      </Link>\n    </div>\n  );\n}\n",
  "components/restaurant/Footer.tsx": "import Link from '@/lib/debugLink';\nimport { getRestaurantIdentity, getContactInfo, getSocialMedia } from '@/lib/restaurantData';\nimport { getContentSmart } from '@/src/lib/data/server-loader';\nimport AllergenNotice from './AllergenNotice';\nimport SimpleFooterHours from '@/components/simple/SimpleFooterHours';\nimport EmojiIcon from '@/components/common/EmojiIcon';\n\nexport default async function Footer() {\n  const identity = getRestaurantIdentity();\n  const contact = getContactInfo();\n  const social = getSocialMedia();\n  const content = await getContentSmart();\n  const footerContent = content.global.navigation.footer;\n\n  return (\n    <footer className=\"bg-brand-700 text-white\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12\">\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-8\">\n          {/* Restaurant Info */}\n          <div className=\"md:col-span-2\">\n                        <h3 className=\"text-2xl font-display font-bold text-accent-400 mb-4\">\n              Old Crown Girton\n            </h3>\n            <p className=\"text-neutral-100 mb-4\">\n              {identity.description} - {identity.tagline}\n            </p>\n            <div className=\"space-y-2 text-sm\">\n              <p><EmojiIcon emoji=\"üìç\" className=\"mr-1\" /> {contact?.address.street}, {contact?.address.area}, {contact?.address.city} {contact?.address.postcode}</p>\n              <p><EmojiIcon emoji=\"üìû\" className=\"mr-1\" /> {contact?.phone.display}</p>\n              <p><EmojiIcon emoji=\"üìß\" className=\"mr-1\" /> {contact?.email.primary}</p>\n            </div>\n          </div>\n\n          {/* Quick Links */}\n          <div>\n            <h4 className=\"text-lg font-semibold mb-4\">{footerContent.sections[0].title}</h4>\n            <ul className=\"space-y-2 text-sm\">\n              {footerContent.sections[0].links.map((link: any, index: number) => (\n                <li key={index}>\n                  <Link href={link.href} className=\"hover:text-foreground-strong transition-colors\">\n                    {link.label}\n                  </Link>\n                </li>\n              ))}\n            </ul>\n          </div>\n\n          {/* Opening Hours */}\n          <div>\n            <h4 className=\"text-lg font-semibold mb-4\">Opening Hours</h4>\n            <SimpleFooterHours />\n          </div>\n        </div>\n\n  <AllergenNotice compact />\n  {/* Social Links & Copyright */}\n        <div className=\"border-t border-neutral-600 mt-8 pt-8 flex flex-col md:flex-row justify-between items-center\">\n            <div className=\"flex space-x-4 mb-4 md:mb-0\">\n            <a href={footerContent.socialMedia.facebook.url} className=\"text-neutral-100 hover:text-foreground-strong transition-colors\" aria-label={footerContent.socialMedia.facebook.label}>\n              <span className=\"sr-only\">Facebook</span>\n              <svg className=\"h-6 w-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path d=\"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z\"/>\n              </svg>\n            </a>\n            <a href={footerContent.socialMedia.instagram.url} className=\"text-neutral-100 hover:text-foreground-strong transition-colors\" aria-label={footerContent.socialMedia.instagram.label}>\n              <span className=\"sr-only\">Instagram</span>\n              <svg className=\"h-6 w-6\" fill=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path d=\"M12.017 0C5.396 0 .029 5.367.029 11.987c0 6.621 5.367 11.987 11.988 11.987 6.62 0 11.987-5.366 11.987-11.987C24.014 5.367 18.637.001 12.017.001zM8.449 16.988c-1.297 0-2.448-.49-3.323-1.291C3.897 14.411 3.29 13.043 3.29 11.498c0-1.544.608-2.913 1.837-4.198.875-.801 2.026-1.291 3.323-1.291 1.297 0 2.448.49 3.323 1.291 1.228 1.285 1.837 2.654 1.837 4.198 0 1.545-.609 2.913-1.837 4.199-.875.8-2.026 1.291-3.323 1.291z\"/>\n              </svg>\n            </a>\n          </div>\n          \n          <div className=\"text-sm text-neutral-100 text-center md:text-right\">\n            <p>{footerContent.copyright}</p>\n            <p className=\"mt-1\">\n              {footerContent.sections[1].links.map((link: any, index: number) => (\n                <span key={index}>\n                  <Link href={link.href} className=\"hover:text-foreground-strong\">{link.label}</Link>\n                  {index < footerContent.sections[1].links.length - 1 && ' | '}\n                </span>\n              ))}\n            </p>\n          </div>\n        </div>\n      </div>\n    </footer>\n  );\n}\n",
  "components/restaurant/AllergenNotice.tsx": "import { getMenu } from '@/lib/restaurantData';\n\nexport default function AllergenNotice({ compact = false }: { compact?: boolean }) {\n  const menu = getMenu();\n  const meta = menu?.metadata;\n  const statement = meta?.allergen_info || 'Please inform us of any allergies before ordering.';\n  const disclaimer = meta?.disclaimer || 'Cross-contamination is possible despite care.';\n  return (\n    <div className={`text-xs ${compact ? 'mt-4' : 'mt-8'} text-neutral-100 leading-relaxed`}>\n      <p><strong>Allergens:</strong> {statement}</p>\n      {!compact && (\n        <>\n          <p>{disclaimer}</p>\n          {meta?.notes?.length ? (\n            <ul className=\"list-disc pl-4 mt-2 space-y-0.5\">\n              {meta.notes.slice(0,3).map((n, i) => <li key={i}>{n}</li>)}\n            </ul>\n          ) : null}\n        </>\n      )}\n    </div>\n  );\n}\n",
  "components/simple/SimpleFooterHours.tsx": "'use client';\n\nimport { useEffect, useState } from 'react';\nimport { fetchWithResilience } from '@/src/lib/data/fetchWithResilience';\n\ninterface SimpleHoursData {\n  kitchen: Record<string, string>;\n  bar: Record<string, string>;\n}\n\nexport default function SimpleFooterHours() {\n  const [hours, setHours] = useState<SimpleHoursData | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    const fetchHours = async () => {\n      try {\n  const response = await fetchWithResilience('/api/restaurant');\n        if (!response.ok) throw new Error('Failed to fetch');\n        \n        const data = await response.json();\n        const hoursData = data.data.hours;\n        \n        setHours(hoursData);\n      } catch (err) {\n        setError(err instanceof Error ? err.message : 'Unknown error');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchHours();\n  }, []);\n\n  if (loading) {\n    return (\n      <div className=\"text-sm text-neutral-100\">\n        <p className=\"font-medium\">Hours</p>\n        <p>Loading‚Ä¶</p>\n      </div>\n    );\n  }\n\n  if (error || !hours) {\n    return (\n      <div className=\"text-sm text-neutral-100\">\n        <p className=\"font-medium\">Hours</p>\n        <p>Call for current hours</p>\n        <p>01223277217</p>\n      </div>\n    );\n  }\n\n  const today = new Date().toLocaleDateString('en-US', { weekday: 'long' }).toLowerCase();\n  const kitchenToday = hours.kitchen[today];\n  const barToday = hours.bar[today];\n\n  // Simple time formatting\n  const formatTime = (timeStr: string) => {\n    if (!timeStr || timeStr === 'Closed') return 'Closed';\n    \n    return timeStr.split(',').map(range => {\n      return range.trim().replace(/(\\d{2}):(\\d{2})/g, (match, hours, minutes) => {\n        const h = parseInt(hours);\n        const m = minutes === '00' ? '' : `:${minutes}`;\n        if (h === 0) return `12${m} AM`;\n        if (h < 12) return `${h}${m} AM`;\n        if (h === 12) return `${h}${m} PM`;\n        return `${h - 12}${m} PM`;\n      }).replace('-', ' ‚Äì ');\n    }).join(', ');\n  };\n\n  const kitchenFormatted = formatTime(kitchenToday);\n  const barFormatted = formatTime(barToday);\n\n  // Check if currently open (simplified)\n  const isCurrentlyOpen = () => {\n    const now = new Date();\n    const currentMinutes = now.getHours() * 60 + now.getMinutes();\n    \n    const checkTimeRange = (timeStr: string) => {\n      if (!timeStr || timeStr === 'Closed') return false;\n      \n      const ranges = timeStr.split(',');\n      for (const range of ranges) {\n        const match = range.trim().match(/(\\d{1,2}):(\\d{2})-(\\d{1,2}):(\\d{2})/);\n        if (match) {\n          const [, startHour, startMin, endHour, endMin] = match;\n          const startMinutes = parseInt(startHour) * 60 + parseInt(startMin);\n          const endMinutes = parseInt(endHour) * 60 + parseInt(endMin);\n          \n          if (currentMinutes >= startMinutes && currentMinutes <= endMinutes) {\n            return true;\n          }\n        }\n      }\n      return false;\n    };\n    \n    return checkTimeRange(kitchenToday) || checkTimeRange(barToday);\n  };\n\n  const isOpen = isCurrentlyOpen();\n\n  return (\n    <div className=\"text-sm space-y-1\">\n      <div>\n        <p className=\"font-medium text-white\">Kitchen</p>\n        <p className=\"text-neutral-200\">{kitchenFormatted}</p>\n      </div>\n      <div className=\"mt-2\">\n        <p className=\"font-medium text-white\">Bar</p>\n        <p className=\"text-neutral-200\">{barFormatted}</p>\n      </div>\n      {isOpen && (\n        <div className=\"mt-2\">\n          <span className=\"inline-flex items-center gap-1 text-xs bg-green-600 text-white px-2 py-1 rounded-full\">\n            <span className=\"w-1.5 h-1.5 bg-green-300 rounded-full\"></span>\n            Open Now\n          </span>\n        </div>\n      )}\n    </div>\n  );\n}\n",
  "components/common/EmojiIcon.tsx": "\"use client\";\n\nimport React from \"react\";\n\ntype EmojiIconProps = {\n  emoji: string;\n  className?: string;\n  size?: \"sm\" | \"md\" | \"lg\" | \"xl\";\n  label?: string; // Optional accessible label for meaningful emoji\n};\n\nconst sizeClasses = {\n  sm: \"text-sm\",\n  md: \"text-base\", \n  lg: \"text-xl\",\n  xl: \"text-2xl\"\n};\n\n/**\n * Consistent emoji icon component that handles accessibility properly.\n * - Decorative emoji (no label): automatically aria-hidden\n * - Meaningful emoji (with label): includes sr-only text for screen readers\n */\nexport function EmojiIcon({ emoji, className = \"\", size = \"md\", label }: EmojiIconProps) {\n  const sizeClass = sizeClasses[size];\n  \n  if (label) {\n    // Meaningful emoji with accessible label\n    return (\n      <span className={`${sizeClass} ${className}`}>\n        <span aria-hidden=\"true\">{emoji}</span>\n        <span className=\"sr-only\">{label}</span>\n      </span>\n    );\n  }\n  \n  // Decorative emoji - hidden from screen readers\n  return (\n    <span \n      className={`${sizeClass} ${className}`}\n      aria-hidden=\"true\"\n    >\n      {emoji}\n    </span>\n  );\n}\n\nexport default EmojiIcon;",
  "components/animations/MotionWrappers.tsx": "\"use client\";\n\nimport React, { ReactNode, CSSProperties } from \"react\";\nimport { motion } from \"framer-motion\";\n\ntype Props = {\n  children: ReactNode;\n  className?: string;\n  style?: CSSProperties;\n  ariaLabel?: string;\n};\n\nexport function FadeIn({ children, className = \"\", style }: Props) {\n  return (\n    <motion.div\n      initial={{ opacity: 0 }}\n      animate={{ opacity: 1 }}\n      transition={{ duration: 0.45 }}\n      className={className}\n      style={style}\n    >\n      {children}\n    </motion.div>\n  );\n}\n\nexport function FadeInUp({ children, className = \"\", style }: Props) {\n  return (\n    <motion.div\n      initial={{ opacity: 0, y: 10 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.45 }}\n      className={className}\n      style={style}\n    >\n      {children}\n    </motion.div>\n  );\n}\n\nexport function BouncyEmoji({ children, className = \"\", style }: Props) {\n  return (\n    <motion.span\n      aria-hidden=\"true\"\n      initial={{ y: 0 }}\n      animate={{ y: [0, -6, 0] }}\n      transition={{ duration: 1, repeat: Infinity, ease: \"easeInOut\" }}\n      className={className}\n      style={style}\n    >\n      {children}\n    </motion.span>\n  );\n}\n\ntype LinkButtonProps = Props & {\n  href: string;\n  onClick?: () => void;\n  download?: string;\n  target?: string;\n  rel?: string;\n};\n\nexport function MotionLinkButton({ children, className = \"\", href, onClick, ariaLabel, download, target, rel }: LinkButtonProps) {\n  return (\n    <motion.a\n      href={href}\n      role=\"button\"\n      onClick={onClick}\n      download={download}\n      target={target}\n      rel={rel}\n      initial={{ opacity: 0, y: 6 }}\n      animate={{ opacity: 1, y: 0 }}\n      whileHover={{ scale: 1.02 }}\n      whileTap={{ scale: 0.98 }}\n      transition={{ duration: 0.2 }}\n      className={className}\n      aria-label={ariaLabel}\n    >\n      {children}\n    </motion.a>\n  );\n}\n\n// No default export ‚Äî module provides named motion helpers\n",
  "components/seo/RestaurantSchema.tsx": "// Restaurant Schema Markup - Comprehensive structured data implementation\n'use client';\n\nimport React, { useEffect } from 'react';\nimport imgExteriorGarden from '@cimages/Slideshow/exterior/the-old-crown-pub-exterior-and-beer-garden.jpeg';\nimport imgCarPark from '@cimages/Slideshow/exterior/large-gravel-car-park-at-the-old-crown-pub.jpeg';\nimport imgInteriorDining from '@cimages/Slideshow/interior/the-old-crown-pub-restaurant-interior-dining.jpg';\nimport imgGardenPicnic from '@cimages/Slideshow/garden/family-friendly-pub-garden-with-picnic-tables.jpeg';\nimport { getRestaurantIdentity, getContactInfo, getHours, getMenu, getTestimonials } from '@/lib/restaurantData';\n\n// Schema.org types for restaurant\ninterface RestaurantSchema {\n  '@context': string;\n  '@type': string;\n  name: string;\n  alternateName?: string;\n  description: string;\n  url: string;\n  telephone: string;\n  email?: string;\n  address: PostalAddress;\n  geo: GeoCoordinates;\n  openingHoursSpecification: OpeningHoursSpecification[];\n  servesCuisine: string[];\n  priceRange: string;\n  paymentAccepted: string[];\n  currenciesAccepted: string;\n  hasMenu: string;\n  menu?: MenuSchema;\n  aggregateRating?: AggregateRating;\n  review?: Review[];\n  image: string[];\n  logo: string;\n  sameAs: string[];\n  amenityFeature?: PropertyValue[];\n  smokingAllowed: boolean;\n  acceptsReservations: boolean;\n  foundingDate?: string;\n  award?: string[];\n}\n\ninterface PostalAddress {\n  '@type': string;\n  streetAddress: string;\n  addressLocality: string;\n  addressRegion: string;\n  postalCode: string;\n  addressCountry: string;\n}\n\ninterface GeoCoordinates {\n  '@type': string;\n  latitude: number;\n  longitude: number;\n}\n\ninterface OpeningHoursSpecification {\n  '@type': string;\n  dayOfWeek: string[];\n  opens: string;\n  closes: string;\n  validFrom?: string;\n  validThrough?: string;\n}\n\ninterface MenuSchema {\n  '@context': string;\n  '@type': string;\n  name: string;\n  description: string;\n  hasMenuSection: MenuSection[];\n}\n\ninterface MenuSection {\n  '@type': string;\n  name: string;\n  description?: string;\n  hasMenuItem: MenuItem[];\n}\n\ninterface MenuItem {\n  '@type': string;\n  name: string;\n  description: string;\n  image?: string;\n  offers: Offer;\n  nutrition?: NutritionInformation;\n  suitableForDiet?: string[];\n  menuAddOn?: MenuAddOn[];\n}\n\ninterface Offer {\n  '@type': string;\n  price: string;\n  priceCurrency: string;\n  availability?: string;\n  validFrom?: string;\n  validThrough?: string;\n}\n\ninterface NutritionInformation {\n  '@type': string;\n  calories?: string;\n  fatContent?: string;\n  saturatedFatContent?: string;\n  carbohydrateContent?: string;\n  sugarContent?: string;\n  proteinContent?: string;\n  sodiumContent?: string;\n}\n\ninterface MenuAddOn {\n  '@type': string;\n  name: string;\n  description?: string;\n  offers: Offer;\n}\n\ninterface AggregateRating {\n  '@type': string;\n  ratingValue: string;\n  bestRating: string;\n  worstRating: string;\n  ratingCount: string;\n}\n\ninterface Review {\n  '@type': string;\n  author: Person;\n  datePublished: string;\n  reviewBody: string;\n  reviewRating: Rating;\n}\n\ninterface Person {\n  '@type': string;\n  name: string;\n}\n\ninterface Rating {\n  '@type': string;\n  ratingValue: string;\n  bestRating: string;\n  worstRating: string;\n}\n\ninterface PropertyValue {\n  '@type': string;\n  name: string;\n  value: boolean | string;\n}\n\n// Build dynamic data from central template to avoid drift\nconst buildBaseData = () => {\n  const identity = getRestaurantIdentity();\n  const contact = getContactInfo();\n  const hours = getHours();\n  const menu = getMenu();\n  \n  // Extract kitchen hours from actual restaurant data\n  const kitchen = hours?.kitchen || {};\n  const openingHours: { days: string[]; opens: string; closes: string }[] = [];\n  \n  // Handle different hour formats with proper type checking\n  Object.entries(kitchen).forEach(([day, ranges]) => {\n    // Type guard to ensure ranges is a string before calling split\n    if (typeof ranges === 'string' && ranges.trim()) {\n      try {\n        const firstRange = ranges.split(',')[0]?.trim();\n        if (firstRange && firstRange.includes('-')) {\n          const [opens, closes] = firstRange.split('-').map(time => time.trim());\n          if (opens && closes) {\n            openingHours.push({ \n              days: [day.charAt(0).toUpperCase() + day.slice(1)], \n              opens, \n              closes \n            });\n          }\n        }\n      } catch (error) {\n        console.warn(`Failed to parse hours for ${day}:`, ranges, error);\n      }\n    } else {\n      console.warn(`Invalid hours format for ${day}:`, ranges);\n    }\n  });\n  \n  const paymentMethods = ['Cash', 'Credit Card', 'Debit Card', 'Contactless'];\n  return { identity, contact, menu, openingHours, paymentMethods };\n};\n\n// Sample menu data for schema\nconst MENU_ITEMS = {\n  starters: [\n    {\n      name: \"Chicken Chilli\",\n      description: \"Tender chicken pieces in a spicy tomato-based sauce with peppers and onions\",\n      price: \"8.95\",\n      image: \"/images/food/CrispyHotWings.jpeg\"\n    },\n    {\n      name: \"Vegetable Samosa\",\n      description: \"Crispy pastry filled with spiced vegetables, served with mint chutney\",\n      price: \"5.95\",\n      suitableForDiet: [\"https://schema.org/VegetarianDiet\"]\n    }\n  ],\n  mains: [\n    {\n      name: \"Chicken Tikka Masala\",\n      description: \"Classic creamy tomato curry with tender chicken tikka pieces\",\n      price: \"13.95\",\n      nutrition: {\n        calories: \"450\",\n        protein: \"35g\",\n        carbohydrates: \"25g\"\n      }\n    },\n    {\n      name: \"Dal Makhani\",\n      description: \"Rich and creamy black lentil curry slow-cooked with butter and spices\",\n      price: \"10.95\",\n      suitableForDiet: [\"https://schema.org/VegetarianDiet\", \"https://schema.org/GlutenFreeDiet\"]\n    }\n  ],\n  desserts: [\n    {\n      name: \"Gulab Jamun\",\n      description: \"Traditional milk dumplings in rose-flavored syrup\",\n      price: \"5.95\"\n    }\n  ]\n};\n\nexport const useRestaurantSchema = () => {\n  const absoluteUrl = (p: string) => {\n    try {\n      const base = process.env.NEXT_PUBLIC_SITE_URL || 'https://oldcrowngirton.com/';\n      return new URL(p, base).toString();\n    } catch {\n      return p;\n    }\n  };\n\n  // Generate main restaurant schema\n  const generateRestaurantSchema = (): RestaurantSchema => {\n    const data = buildBaseData();\n    const testimonials = getTestimonials() || [];\n    const ratingValue = testimonials.length\n      ? (testimonials.reduce((s: number, t: any) => s + (t.rating || 0), 0) / testimonials.length).toFixed(1)\n      : '4.8';\n    const reviews: Review[] = testimonials.slice(0, 12).map((t: any) => ({\n      '@type': 'Review',\n      author: { '@type': 'Person', name: t.author },\n      datePublished: t.date,\n      reviewBody: t.text,\n      reviewRating: {\n        '@type': 'Rating',\n        ratingValue: String(t.rating),\n        bestRating: '5',\n        worstRating: '1'\n      }\n    }));\n    return {\n      '@context': 'https://schema.org',\n      '@type': 'Restaurant',\n      name: data.identity.name,\n      alternateName: data.identity.tagline,\n      description: data.identity.description,\n      url: 'https://oldcrowngirton.com/',\n      telephone: data.contact?.phone.primary,\n      email: data.contact?.email.primary,\n      address: {\n        '@type': 'PostalAddress',\n        streetAddress: data.contact?.address.street,\n        addressLocality: data.contact?.address.area,\n        addressRegion: data.contact?.address.city,\n        postalCode: data.contact?.address.postcode,\n        addressCountry: data.contact?.address.country\n      },\n      geo: {\n        '@type': 'GeoCoordinates',\n        latitude: data.contact?.address.coordinates.lat,\n        longitude: data.contact?.address.coordinates.lng\n      },\n      openingHoursSpecification: data.openingHours.map(h => ({\n        '@type': 'OpeningHoursSpecification',\n        dayOfWeek: h.days.map(day => `https://schema.org/${day}`),\n        opens: h.opens,\n        closes: h.closes\n      })),\n      servesCuisine: data.identity.cuisine_types,\n      priceRange: '¬£¬£',\n      paymentAccepted: data.paymentMethods,\n      currenciesAccepted: 'GBP',\n      hasMenu: 'https://oldcrowngirton.com/menu',\n      image: [\n        absoluteUrl(typeof imgExteriorGarden === 'string' ? imgExteriorGarden : (imgExteriorGarden as any)),\n        absoluteUrl(typeof imgInteriorDining === 'string' ? imgInteriorDining : (imgInteriorDining as any)),\n        absoluteUrl(typeof imgGardenPicnic === 'string' ? imgGardenPicnic : (imgGardenPicnic as any)),\n        absoluteUrl(typeof imgCarPark === 'string' ? imgCarPark : (imgCarPark as any)),\n      ],\n      logo: absoluteUrl('/images/brand/Oldcrowngirtonlogo.png'),\n      sameAs: [\n        'https://www.facebook.com/oldcrowngirton',\n        'https://www.instagram.com/oldcrowngirton'\n      ],\n      smokingAllowed: false,\n      acceptsReservations: true,\n      foundingDate: data.identity.established,\n      aggregateRating: {\n        '@type': 'AggregateRating',\n        ratingValue,\n        bestRating: '5',\n        worstRating: '1',\n        ratingCount: String(testimonials.length)\n      },\n      review: reviews\n    };\n  };\n\n  // Generate menu schema\n  const generateMenuSchema = (): MenuSchema => {\n    return {\n      '@context': 'https://schema.org',\n      '@type': 'Menu',\n      name: 'Old Crown Restaurant Menu',\n      description: 'Authentic Nepalese cuisine and traditional pub classics',\n      hasMenuSection: [\n        {\n          '@type': 'MenuSection',\n          name: 'Starters',\n          description: 'Appetizers and small plates to begin your meal',\n          hasMenuItem: MENU_ITEMS.starters.map(item => ({\n            '@type': 'MenuItem',\n            name: item.name,\n            description: item.description,\n            image: item.image,\n            offers: {\n              '@type': 'Offer',\n              price: item.price,\n              priceCurrency: 'GBP',\n              availability: 'https://schema.org/InStock'\n            },\n            suitableForDiet: item.suitableForDiet || []\n          }))\n        },\n        {\n          '@type': 'MenuSection',\n          name: 'Main Courses',\n          description: 'Hearty main dishes featuring authentic flavors',\n          hasMenuItem: MENU_ITEMS.mains.map(item => ({\n            '@type': 'MenuItem',\n            name: item.name,\n            description: item.description,\n            offers: {\n              '@type': 'Offer',\n              price: item.price,\n              priceCurrency: 'GBP',\n              availability: 'https://schema.org/InStock'\n            },\n            nutrition: item.nutrition ? {\n              '@type': 'NutritionInformation',\n              calories: item.nutrition.calories,\n              proteinContent: item.nutrition.protein,\n              carbohydrateContent: item.nutrition.carbohydrates\n            } : undefined,\n            suitableForDiet: item.suitableForDiet || []\n          }))\n        },\n        {\n          '@type': 'MenuSection',\n          name: 'Desserts',\n          description: 'Sweet endings to your dining experience',\n          hasMenuItem: MENU_ITEMS.desserts.map(item => ({\n            '@type': 'MenuItem',\n            name: item.name,\n            description: item.description,\n            offers: {\n              '@type': 'Offer',\n              price: item.price,\n              priceCurrency: 'GBP',\n              availability: 'https://schema.org/InStock'\n            }\n          }))\n        }\n      ]\n    };\n  };\n\n  // Generate breadcrumb schema\n  const generateBreadcrumbSchema = (items: Array<{name: string, url: string}>) => {\n    return {\n      '@context': 'https://schema.org',\n      '@type': 'BreadcrumbList',\n      itemListElement: items.map((item, index) => ({\n        '@type': 'ListItem',\n        position: index + 1,\n        name: item.name,\n        item: item.url\n      }))\n    };\n  };\n\n  // Generate event schema for special occasions\n  const generateEventSchema = (eventData: {\n    name: string;\n    description: string;\n    startDate: string;\n    endDate?: string;\n    location?: string;\n    offers?: { price: string; url: string };\n  }) => {\n    const data = buildBaseData();\n    return {\n      '@context': 'https://schema.org',\n      '@type': 'Event',\n      name: eventData.name,\n      description: eventData.description,\n      startDate: eventData.startDate,\n      endDate: eventData.endDate,\n      location: {\n        '@type': 'Place',\n        name: data.identity.name,\n        address: {\n          '@type': 'PostalAddress',\n          streetAddress: data.contact?.address.street,\n          addressLocality: data.contact?.address.area,\n          addressRegion: data.contact?.address.city,\n          postalCode: data.contact?.address.postcode,\n          addressCountry: data.contact?.address.country\n        }\n      },\n      organizer: {\n        '@type': 'Organization',\n        name: data.identity.name,\n        url: 'https://oldcrowngirton.com/'\n      },\n      offers: eventData.offers ? {\n        '@type': 'Offer',\n        price: eventData.offers.price,\n        priceCurrency: 'GBP',\n        url: eventData.offers.url\n      } : undefined\n    };\n  };\n\n  const generateLocalBusinessSchema = () => {\n    const data = buildBaseData();\n    return {\n      '@context': 'https://schema.org',\n      '@type': 'LocalBusiness',\n      name: data.identity.name,\n      description: data.identity.description,\n      telephone: data.contact?.phone.primary,\n      email: data.contact?.email.primary,\n      address: {\n        '@type': 'PostalAddress',\n        streetAddress: data.contact?.address.street,\n        addressLocality: data.contact?.address.area,\n        addressRegion: data.contact?.address.city,\n        postalCode: data.contact?.address.postcode,\n        addressCountry: data.contact?.address.country\n      },\n      openingHoursSpecification: data.openingHours.map(h => ({\n        '@type': 'OpeningHoursSpecification',\n        dayOfWeek: h.days.map(day => `https://schema.org/${day}`),\n        opens: h.opens,\n        closes: h.closes\n      }))\n    };\n  };\n\n  const generateFAQSchema = (faqs: { question: string; answer: string }[]) => ({\n    '@context': 'https://schema.org',\n    '@type': 'FAQPage',\n    mainEntity: faqs.map(f => ({\n      '@type': 'Question',\n      name: f.question,\n      acceptedAnswer: { '@type': 'Answer', text: f.answer }\n    }))\n  });\n\n  return {\n    generateRestaurantSchema,\n    generateMenuSchema,\n    generateBreadcrumbSchema,\n    generateEventSchema,\n    generateLocalBusinessSchema,\n    generateFAQSchema\n  };\n};\n\n// Schema injection component\ninterface SchemaInjectorProps {\n  type: 'restaurant' | 'menu' | 'breadcrumb' | 'event' | 'local' | 'faq';\n  data?: any;\n  page?: string;\n}\n\nexport const SchemaInjector = ({ type, data, page = 'home' }: SchemaInjectorProps): null => {\n  const { generateRestaurantSchema, generateMenuSchema, generateBreadcrumbSchema, generateEventSchema, generateLocalBusinessSchema, generateFAQSchema } = useRestaurantSchema();\n\n  useEffect(() => {\n    let schema: any = {};\n\n    switch (type) {\n      case 'restaurant':\n        schema = generateRestaurantSchema();\n        break;\n      case 'menu':\n        schema = generateMenuSchema();\n        break;\n      case 'breadcrumb':\n        schema = generateBreadcrumbSchema(data || []);\n        break;\n      case 'event':\n        schema = generateEventSchema(data);\n        break;\n      case 'local':\n        schema = generateLocalBusinessSchema();\n        break;\n      case 'faq':\n        schema = generateFAQSchema(data || []);\n        break;\n      default:\n        return;\n    }\n\n    // Remove existing schema of the same type\n    const existingScript = document.querySelector(`script[data-schema-type=\"${type}\"]`);\n    if (existingScript) {\n      existingScript.remove();\n    }\n\n    // Inject new schema\n    const script = document.createElement('script');\n    script.type = 'application/ld+json';\n    script.setAttribute('data-schema-type', type);\n    script.setAttribute('data-page', page);\n    script.textContent = JSON.stringify(schema, null, 2);\n    \n    document.head.appendChild(script);\n\n    // Cleanup on unmount\n    return () => {\n      const scriptToRemove = document.querySelector(`script[data-schema-type=\"${type}\"][data-page=\"${page}\"]`);\n      if (scriptToRemove) {\n        scriptToRemove.remove();\n      }\n    };\n  }, [type, data, page, generateRestaurantSchema, generateMenuSchema, generateBreadcrumbSchema, generateEventSchema, generateLocalBusinessSchema, generateFAQSchema]);\n\n  return null; // This component doesn't render anything\n};\n\n// Restaurant Schema Provider - automatically injects restaurant schema on all pages\nexport const RestaurantSchemaProvider = ({ children }: { children: React.ReactNode }) => {\n  return (\n    <>\n      <SchemaInjector type=\"restaurant\" />\n      {children}\n    </>\n  );\n};\n\nexport default SchemaInjector;\n",
  "libs/seo.tsx": "import type { Metadata } from \"next\";\nimport type { ReactElement } from \"react\";\nimport config from \"@/config\";\n\n/**\n * Contract for getSEOTags inputs.\n * We accept all Next.js Metadata fields and two helpers:\n * - canonicalUrlRelative: relative path (e.g. \"/about\") that will be turned into the canonical alternate\n * - extraTags: arbitrary extra metadata you may want to merge in\n */\ntype SEOTagOptions = Metadata & {\n  canonicalUrlRelative?: string;\n  extraTags?: Record<string, any>;\n};\n\n/**\n * Build a Metadata object prefilled from `config` with sane defaults.\n * Returns a value compatible with Next.js app router `metadata` export.\n */\nexport const getSEOTags = (opts: SEOTagOptions = {}): Metadata => {\n  const { title, description, keywords, openGraph, canonicalUrlRelative, extraTags } = opts;\n\n  const metadataBase = new URL(\n    process.env.NODE_ENV === \"development\" ? \"http://localhost:3000/\" : `https://${config.domainName}/`\n  );\n\n  // Normalize keywords: accept string | string[] | undefined\n  const normalizedKeywords: Metadata[\"keywords\"] = Array.isArray(keywords)\n    ? keywords\n    : typeof keywords === \"string\"\n    ? keywords.split(\",\").map((k) => k.trim()).filter(Boolean)\n    : [config.appName];\n\n  const defaultOGUrl = `${metadataBase.origin}/`;\n\n  const metadata: Metadata = {\n    title: title || config.appName,\n    description: description || config.appDescription,\n    keywords: normalizedKeywords,\n    applicationName: config.appName,\n    metadataBase,\n\n    openGraph: {\n      title: openGraph?.title || title || config.appName,\n      description: openGraph?.description || description || config.appDescription,\n      url: openGraph?.url || defaultOGUrl,\n      siteName: openGraph?.siteName || config.appName,\n      locale: \"en_US\",\n      type: \"website\",\n      ...(openGraph?.images ? { images: openGraph.images } : {}),\n    },\n\n    twitter: {\n      title: openGraph?.title || title || config.appName,\n      description: openGraph?.description || description || config.appDescription,\n      card: \"summary_large_image\",\n      creator: \"@lapeninns\",\n    },\n\n    // Merge any additional tags (be careful not to clobber typed fields)\n    ...extraTags,\n  };\n\n  if (canonicalUrlRelative) {\n    // Next.js will resolve this relative canonical with metadataBase\n    metadata.alternates = { canonical: canonicalUrlRelative };\n  }\n\n  return metadata;\n};\n\n/**\n * Render structured data scripts for Schema.org rich results.\n * Pass an array of JSON-LD objects or let the helper render a sensible default.\n */\nexport const renderSchemaTags = (schemas?: Array<Record<string, any>>): ReactElement | null => {\n  const defaultSchema: Record<string, any> = {\n    \"@context\": \"https://schema.org\",\n    \"@type\": \"Restaurant\",\n    name: config.appName,\n    description: config.appDescription,\n    image: `${config.domainName.startsWith(\"http\") ? config.domainName : `https://${config.domainName}`}/icon.png`,\n    url: `https://${config.domainName}/`,\n    telephone: \"+44 1223 277217\",\n    email: \"oldcrown@lapeninns.com\",\n    address: {\n      \"@type\": \"PostalAddress\",\n      streetAddress: \"89 High Street\",\n      addressLocality: \"Girton\",\n      addressRegion: \"Cambridgeshire\",\n      postalCode: \"CB3 0QD\",\n      addressCountry: \"GB\"\n    },\n    geo: {\n      \"@type\": \"GeoCoordinates\",\n      latitude: \"52.2434\",\n      longitude: \"0.0732\"\n    },\n    openingHoursSpecification: [\n      {\n        \"@type\": \"OpeningHoursSpecification\",\n        dayOfWeek: [\"Monday\"],\n        opens: \"12:00\",\n        closes: \"22:00\"\n      },\n      {\n        \"@type\": \"OpeningHoursSpecification\",\n        dayOfWeek: [\"Tuesday\"],\n        opens: \"12:00\",\n        closes: \"22:00\"\n      },\n      {\n        \"@type\": \"OpeningHoursSpecification\",\n        dayOfWeek: [\"Wednesday\"],\n        opens: \"12:00\",\n        closes: \"22:00\"\n      },\n      {\n        \"@type\": \"OpeningHoursSpecification\",\n        dayOfWeek: [\"Thursday\"],\n        opens: \"12:00\",\n        closes: \"22:00\"\n      },\n      {\n        \"@type\": \"OpeningHoursSpecification\",\n        dayOfWeek: [\"Friday\"],\n        opens: \"12:00\",\n        closes: \"23:00\"\n      },\n      {\n        \"@type\": \"OpeningHoursSpecification\",\n        dayOfWeek: [\"Saturday\"],\n        opens: \"12:00\",\n        closes: \"23:00\"\n      },\n      {\n        \"@type\": \"OpeningHoursSpecification\",\n        dayOfWeek: [\"Sunday\"],\n        opens: \"12:00\",\n        closes: \"22:00\"\n      }\n    ],\n    servesCuisine: [\"Nepalese\", \"British\", \"Pub Food\"],\n    priceRange: \"¬£¬£\",\n    acceptsReservations: true,\n    hasMenu: `https://${config.domainName}/menu`,\n    aggregateRating: {\n      \"@type\": \"AggregateRating\",\n      ratingValue: \"4.5\",\n      reviewCount: \"127\"\n    }\n  };\n\n  const schemasToRender = schemas && schemas.length > 0 ? schemas : [defaultSchema];\n\n  return (\n    <>\n      {schemasToRender.map((schema, i) => (\n        <script\n          key={i}\n          type=\"application/ld+json\"\n          // eslint-disable-next-line react/no-danger\n          dangerouslySetInnerHTML={{ __html: JSON.stringify(schema) }}\n        />\n      ))}\n    </>\n  );\n};\n",
  "lib/debugLink.tsx": "\"use client\";\n\nimport Link from 'next/link';\nimport { useMemo } from 'react';\n\n// Minimal UrlObject shape we care about (avoid importing Node 'url' types into client bundle)\ntype UrlLike = { pathname: string; query?: Record<string, any>; hash?: string } | string;\n\ninterface DebugLinkProps {\n  href: UrlLike | any; // any to surface unexpected shapes during development\n  children: React.ReactNode;\n  [key: string]: any; // pass-through props\n}\n\n/**\n * DebugLink: development helper around next/link that prevents accidental\n * coercion of valid Link UrlObjects into the literal string \"[object Object]\".\n *\n * Root cause of the 404s like GET /[object%20Object]: a previous implementation\n * always executed String(href) which destroys the structured object form that\n * Next.js accepts and prefetches, yielding a broken path.\n *\n * This component now:\n *  - Passes through proper object hrefs untouched\n *  - Logs (once per different bad input) when an obviously malformed object is supplied\n *  - Guards against already-coerced \"[object Object]\" strings and falls back to '/'\n */\nconst seenBadInputs = new Set<string>();\n\nexport default function DebugLink({ href, children, ...props }: DebugLinkProps) {\n  const normalizedHref: UrlLike = useMemo(() => {\n    // If it's a string, validate it\n    if (typeof href === 'string') {\n      if (href.includes('[object Object]')) {\n        if (!seenBadInputs.has(href)) {\n          seenBadInputs.add(href);\n          // eslint-disable-next-line no-console\n          console.error('üö® DebugLink: href string contains [object Object]; falling back to /', { href });\n        }\n        return '/';\n      }\n      return href;\n    }\n\n    // Accept object form if it has a pathname\n    if (href && typeof href === 'object') {\n      // Typical Next.js UrlObject shape\n      if (typeof href.pathname === 'string') {\n        return href as any; // keep structure for Next.js routing\n      }\n\n      // Legacy shapes we might try to salvage\n      if (typeof href.href === 'string') {\n        const candidate = href.href;\n        if (candidate.includes('[object Object]')) {\n          if (!seenBadInputs.has(candidate)) {\n            seenBadInputs.add(candidate);\n            // eslint-disable-next-line no-console\n            console.error('üö® DebugLink: object href.href already corrupted', { href });\n          }\n          return '/';\n        }\n        return candidate;\n      }\n\n      const signature = Object.keys(href).sort().join(',');\n      if (!seenBadInputs.has(signature)) {\n        seenBadInputs.add(signature);\n        // eslint-disable-next-line no-console\n        console.error('üö® DebugLink: unsupported href object shape; coercing to /', { href });\n      }\n      return '/';\n    }\n\n    // Fallback for null/undefined\n    if (!href) return '/';\n\n    // Anything else (number, boolean, function) => log once and fallback\n    const key = typeof href + ':' + (typeof href === 'object' ? JSON.stringify(href) : String(href));\n    if (!seenBadInputs.has(key)) {\n      seenBadInputs.add(key);\n      // eslint-disable-next-line no-console\n      console.error('üö® DebugLink: unexpected href type; coercing to /', { href });\n    }\n    return '/';\n  }, [href]);\n\n  return (\n    <Link href={normalizedHref as any} {...props}>\n      {children}\n    </Link>\n  );\n}",
  "lib/restaurantData.ts": "// Restaurant Data Utility - Unified Template Integration\n// This file provides utilities to work with the unified restaurant template data\n\n\n// Import the restaurant data statically (works in Next.js)\nimport restaurantTemplate from '../config/restaurant.json';\n// Import the validated menu data\n\n\n// Types for the unified restaurant template\nexport interface RestaurantTemplate {\n  restaurant: {\n    identity: {\n      name: string;\n      tagline: string;\n      description: string;\n      established: string;\n      type: string;\n      cuisine_types: string[];\n      logo: {\n        main: string;\n        favicon: string;\n        alt: string;\n      };\n    };\n    contact: {\n      phone: {\n        primary: string;\n        display: string;\n        whatsapp: string;\n      };\n      email: {\n        primary: string;\n        bookings: string;\n        events: string;\n      };\n      address: {\n        street: string;\n        area: string;\n        city: string;\n        postcode: string;\n        country: string;\n        coordinates: {\n          lat: number;\n          lng: number;\n        };\n        google_maps_url: string;\n      };\n    };\n    hours: {\n      kitchen: Record<string, string>;\n      bar: Record<string, string>;\n      display: {\n        kitchen: Record<string, string>;\n        bar: Record<string, string>;\n      };\n    };\n    social: {\n      facebook: { url: string; handle: string };\n      instagram: { url: string; handle: string };\n      twitter: { url: string; handle: string };\n      website: string;\n    };\n  };\n  menu: {\n    metadata: {\n      last_updated: string;\n      version: string;\n      currency: string;\n      currency_symbol: string;\n      allergen_info: string;\n      disclaimer: string;\n      notes: string[];\n      dietary_legend: Record<string, string>;\n    };\n    categories: MenuCategory[];\n  };\n  gallery: {\n    hero: {\n      main: { src: string; alt: string; caption: string };\n      secondary: Array<{ src: string; alt: string; caption: string }>;\n    };\n    categories: {\n      dishes: Array<{ src: string; alt: string; caption: string; category?: string }>;\n      restaurant: Array<{ src: string; alt: string; caption: string }>;\n      events: Array<{ src: string; alt: string; caption: string }>;\n    };\n  };\n  testimonials: Array<{\n    id: string;\n    text: string;\n    author: string;\n    rating: number;\n    date: string;\n    verified: boolean;\n    platform: string;\n    location: string;\n  }>;\n  events: Array<{\n    id: string;\n    title: string;\n    description: string;\n    date: { start: string; end: string };\n    image: string;\n    special_menu: boolean;\n    booking_required: boolean;\n    discount?: { type: string; value: number; description: string };\n    offer?: string;\n  }>;\n  seo: {\n    title: string;\n    description: string;\n    keywords: string[];\n    og: {\n      title: string;\n      description: string;\n      image: string;\n      url: string;\n    };\n    schema: Record<string, any>;\n  };\n  features: {\n    services: Record<string, boolean>;\n    dining: Record<string, boolean>;\n    accessibility: Record<string, boolean>;\n    amenities: Record<string, boolean>;\n    payment_methods: string[];\n  };\n  delivery: {\n    available: boolean;\n    radius_miles: number;\n    minimum_order: { amount: number; display: string };\n    delivery_fee: { amount: number; display: string };\n    free_delivery_threshold: { amount: number; display: string };\n    estimated_time: string;\n    partners: Array<{ name: string; url: string }>;\n    coverage_areas: string[];\n  };\n  booking: {\n    phone: string;\n    email: string;\n    online_booking: boolean;\n    advance_booking_days: number;\n    party_size_limit: number;\n    deposit_required: boolean;\n    cancellation_policy: string;\n  };\n  nutrition: {\n    allergen_policy: string;\n    common_allergens: string[];\n    dietary_accommodations: string[];\n  };\n  template_info: {\n    version: string;\n    created: string;\n    description: string;\n    structure: string;\n    usage: string;\n  };\n}\n\nexport interface MenuCategory {\n  id: string;\n  name: string;\n  description: string;\n  order: number;\n  subcategories: MenuSubcategory[];\n}\n\nexport interface MenuSubcategory {\n  id: string;\n  name: string;\n  order: number;\n  items: MenuItem[];\n}\n\nexport interface MenuItem {\n  id: string;\n  name: string;\n  description: string;\n  price: {\n    amount: number;\n    display: string;\n  };\n  dietary: string[];\n  spice_level: number;\n  image: string;\n  available: boolean;\n  popular: boolean;\n  prep_time: string;\n}\n\n// Utility functions\n\n// Utility functions for accessing restaurant data with fallbacks for simplified structure\nexport const getRestaurantIdentity = () => ({\n  name: (restaurantTemplate as any)?.name || \"Old Crown Girton\",\n  tagline: \"Historic Thatched Pub & Nepalese Restaurant\",\n  description: \"Authentic Nepalese cuisine and traditional British pub classics\",\n  established: \"1850\",\n  type: \"restaurant\",\n  cuisine_types: [\"Nepalese\", \"British\", \"Pub Food\"]\n});\n\nexport const getContactInfo = () => ({\n  phone: {\n    primary: (restaurantTemplate as any)?.phone || \"+44 1223 277217\",\n    display: \"01223277217\",\n    whatsapp: (restaurantTemplate as any)?.phone || \"+44 1223 277217\"\n  },\n  email: {\n    primary: (restaurantTemplate as any)?.email || \"oldcrown@lapeninns.com\",\n    bookings: (restaurantTemplate as any)?.email || \"oldcrown@lapeninns.com\",\n    events: (restaurantTemplate as any)?.email || \"oldcrown@lapeninns.com\"\n  },\n  address: {\n    street: (restaurantTemplate as any)?.address?.street || \"89 High Street\",\n    area: \"Girton\",\n    city: (restaurantTemplate as any)?.address?.city || \"Girton\",\n    postcode: (restaurantTemplate as any)?.address?.zip || \"CB3 0QD\",\n    country: \"GB\",\n    coordinates: { lat: 52.2385, lng: 0.0926 },\n    google_maps_url: \"https://maps.google.com/?q=52.2385,0.0926\"\n  }\n});\n\nexport const getHours = () => {\n  // Try to read from the actual restaurant data if available, otherwise use fallback\n  const hours = (restaurantTemplate as any)?.hours;\n  \n  if (hours && hours.kitchen && hours.bar) {\n    // Use the actual restaurant.json data\n    return {\n      kitchen: hours.kitchen,\n      bar: hours.bar,\n      display: {\n        kitchen: {\n          \"weekdays\": generateDisplayHours(hours.kitchen, ['monday', 'tuesday', 'wednesday', 'thursday']),\n          \"friday\": generateDisplayHours(hours.kitchen, ['friday']),\n          \"saturday\": generateDisplayHours(hours.kitchen, ['saturday']),\n          \"sunday\": generateDisplayHours(hours.kitchen, ['sunday'])\n        },\n        bar: {\n          \"mon_thu\": generateDisplayHours(hours.bar, ['monday', 'tuesday', 'wednesday', 'thursday']),\n          \"fri_sat\": generateDisplayHours(hours.bar, ['friday', 'saturday']),\n          \"sunday\": generateDisplayHours(hours.bar, ['sunday'])\n        }\n      }\n    };\n  }\n  \n  // Fallback to hardcoded data if restaurant.json is not available\n  return {\n    kitchen: {\n      \"monday\": \"12:00-22:00\",\n      \"tuesday\": \"12:00-22:00\",\n      \"wednesday\": \"12:00-22:00\", \n      \"thursday\": \"12:00-22:00\",\n      \"friday\": \"12:00-22:30\",\n      \"saturday\": \"12:00-22:30\",\n      \"sunday\": \"12:00-21:30\"\n    },\n    bar: {\n      \"monday\": \"12:00-23:00\",\n      \"tuesday\": \"12:00-23:00\",\n      \"wednesday\": \"12:00-23:00\",\n      \"thursday\": \"12:00-23:00\",\n      \"friday\": \"12:00-00:00\",\n      \"saturday\": \"12:00-00:00\",\n      \"sunday\": \"12:00-22:30\"\n    },\n    display: {\n      kitchen: {\n        \"weekdays\": \"Mon-Thu: 12:00-22:00\",\n        \"friday\": \"Fri: 12:00-22:30\",\n        \"saturday\": \"Sat: 12:00-22:30\",\n        \"sunday\": \"Sun: 12:00-21:30\"\n      },\n      bar: {\n        \"mon_thu\": \"Mon-Thu: 12:00-23:00\",\n        \"fri_sat\": \"Fri-Sat: 12:00-00:00\",\n        \"sunday\": \"Sun: 12:00-22:30\"\n      }\n    }\n  };\n};\n\n// Helper function to generate display strings from hours data\nfunction generateDisplayHours(hoursData: Record<string, string>, days: string[]): string {\n  if (days.length === 0) return '';\n  \n  // Get hours for the specified days\n  const dayHours = days.map(day => hoursData[day]).filter(Boolean);\n  \n  if (dayHours.length === 0) return 'Closed';\n  \n  // Check if all days have the same hours\n  const firstHours = dayHours[0];\n  const allSame = dayHours.every(hours => hours === firstHours);\n  \n  if (allSame) {\n    const dayAbbrevs = {\n      'monday': 'Mon', 'tuesday': 'Tue', 'wednesday': 'Wed', 'thursday': 'Thu',\n      'friday': 'Fri', 'saturday': 'Sat', 'sunday': 'Sun'\n    };\n    \n    const dayNames = days.map(day => dayAbbrevs[day as keyof typeof dayAbbrevs]);\n    const rangeStr = dayNames.length > 1 ? `${dayNames[0]}-${dayNames[dayNames.length - 1]}` : dayNames[0];\n    \n    return `${rangeStr}: ${firstHours.replace(',', ', ')}`;\n  }\n  \n  // If different hours, return the first day's hours\n  return `${days[0]}: ${firstHours.replace(',', ', ')}`;\n}\n\nexport const getMenu = () => ({\n  metadata: {\n    last_updated: new Date().toISOString(),\n    version: \"1.0.0\",\n    currency: \"GBP\",\n    currency_symbol: \"¬£\",\n    allergen_info: \"Please inform us of any allergies before ordering.\",\n    disclaimer: \"Cross-contamination is possible despite care.\",\n    notes: [\"All dishes are prepared fresh to order\"],\n    dietary_legend: { \"veg\": \"Vegetarian\", \"GF\": \"Gluten Free\" }\n  },\n  categories: [] as MenuCategory[]\n});\n\nexport const getMenuCategories = (): MenuCategory[] => [];\nexport const getTestimonials = (): any[] => [];\nexport const getEvents = (): any[] => [];\nexport const getGallery = (): any => ({ hero: { main: { src: \"\", alt: \"\", caption: \"\" }, secondary: [] }, categories: { dishes: [], restaurant: [], events: [] } });\nexport const getSEO = (): any => ({ title: \"Old Crown Girton\", description: \"Historic thatched pub and Nepalese restaurant\", keywords: [], og: { title: \"\", description: \"\", image: \"\", url: \"\" }, schema: {} });\nexport const getSocialMedia = (): any => ({ facebook: { url: \"\", handle: \"\" }, instagram: { url: \"\", handle: \"\" }, twitter: { url: \"\", handle: \"\" }, website: \"https://oldcrowngirton.com/\" });\nexport const getDeliveryInfo = (): any => ({ available: true, radius_miles: 5, minimum_order: { amount: 15, display: \"¬£15.00\" }, delivery_fee: { amount: 2.50, display: \"¬£2.50\" }, free_delivery_threshold: { amount: 25, display: \"¬£25.00\" }, estimated_time: \"30-45 minutes\", partners: [], coverage_areas: [] });\nexport const getFeatures = (): any => ({ services: {}, dining: {}, accessibility: {}, amenities: {}, payment_methods: [\"Cash\", \"Card\"] });\n\n\n",
  "lib/dataLoader.ts": "// Universal client-side JSON loader with runtime base URL resolution\n// Works in Next.js client components (and Vite if ported)\n\nimport { fetchWithResilience } from '@/src/lib/data/fetchWithResilience';\nconst normalize = (s: string) => s.replace(/\\/+$/, \"\");\nconst join = (a: string, b: string) => `${normalize(a)}/${b.replace(/^\\/+/, \"\")}`;\n\n// Determine base at runtime (env var or fallback to /data)\nexport const getDataBase = (): string => {\n  // Next.js public env\n  const next = typeof process !== 'undefined' ? (process as any)?.env?.NEXT_PUBLIC_DATA_BASE_URL : undefined;\n  return next || '/data';\n};\n\ninterface CacheEntry<T> {\n  promise?: Promise<T>;\n  data?: T;\n  etag?: string | null;\n  lastFetched?: number;\n}\n\nconst cache = new Map<string, CacheEntry<any>>();\n\ntype Strategy = 'network-first' | 'stale-while-revalidate';\n\ninterface FetchOptions {\n  strategy?: Strategy;\n  retries?: number; // network retries\n  retryDelayMs?: number; // base delay\n  ttlMs?: number; // minimum age before background refresh (SWR)\n  force?: boolean; // force a network request now\n}\n\nconst DEFAULT_OPTS: Required<Pick<FetchOptions, 'strategy' | 'retries' | 'retryDelayMs' | 'ttlMs' | 'force'>> = {\n  strategy: 'stale-while-revalidate',\n  retries: 2,\n  retryDelayMs: 300,\n  ttlMs: 60_000, // 1 minute default TTL\n  force: false,\n};\n\nasync function fetchWithRetry(url: string, init: any, retries: number, delay: number): Promise<Response> { // intentionally using any for flexible RequestInit\n  let attempt = 0;\n  // Exponential backoff with jitter; stop after retries exceeded\n  // Using while loop with explicit break to satisfy lint (no constant condition)\n  // attempt 0 = first try, up to retries inclusive attempts\n  // e.g. retries=2 => attempts 0,1,2 (3 total)\n  for (;;) { // eslint-disable-line no-constant-condition\n    try {\n      return fetchWithResilience(url, init, { tries: retries + 1, timeoutMs: 15000, baseBackoffMs: delay });\n    } catch (e) {\n      if (attempt >= retries) throw e;\n      const wait = delay * Math.pow(2, attempt) + Math.random() * 100;\n      await new Promise((res) => setTimeout(res, wait));\n      attempt++;\n    }\n  }\n}\n\nexport async function fetchJSON<T>(path: string, opts: FetchOptions = {}): Promise<T> {\n  const { strategy, retries, retryDelayMs, ttlMs, force } = { ...DEFAULT_OPTS, ...opts };\n  // Preserve absolute URLs and root-relative paths (e.g. /api/*) to avoid accidental prefixing\n  const isAbsolute = /^(https?:)?\\//.test(path); // starts with http(s):// or /\n  const url = isAbsolute ? path : join(getDataBase(), path);\n  let entry = cache.get(url) as CacheEntry<T> | undefined;\n  if (!entry) {\n    entry = {};\n    cache.set(url, entry);\n  }\n\n  // If we already have data and strategy is stale-while-revalidate, kick off background refresh\n  if (!force && entry.data && strategy === 'stale-while-revalidate' && !entry.promise) {\n    const age = entry.lastFetched ? Date.now() - entry.lastFetched : Infinity;\n    const needsRefresh = age >= ttlMs;\n    if (!needsRefresh) return entry.data; // fresh enough\n    // Fire and forget refresh using ETag if available\n    entry.promise = (async () => {\n      try {\n        const headers: Record<string, string> = { 'cache-control': 'no-store' };\n        if (entry!.etag) headers['If-None-Match'] = entry!.etag;\n        const resp = await fetchWithRetry(url, { headers }, retries, retryDelayMs);\n        if (resp.status === 304) {\n          // Not modified\n          return entry!.data as T;\n        }\n        if (!resp.ok) throw new Error(`Fetch failed ${resp.status} for ${url}`);\n        entry!.etag = resp.headers.get('ETag');\n        const json = await resp.json();\n        entry!.data = json;\n        entry!.lastFetched = Date.now();\n        return json as T;\n      } finally {\n        entry!.promise = undefined; // allow future refreshes\n      }\n    })();\n    // Return stale immediately\n    return entry.data;\n  }\n\n  // If an in-flight promise exists, reuse it\n  if (entry.promise) return entry.promise;\n\n  // Otherwise perform network (initial | network-first | force)\n  entry.promise = (async () => {\n    const headers: Record<string, string> = { 'cache-control': 'no-store' };\n    if (entry!.etag) headers['If-None-Match'] = entry!.etag;\n    const resp = await fetchWithRetry(url, { headers }, retries, retryDelayMs);\n    if (resp.status === 304 && entry!.data) {\n      return entry!.data; // still valid\n    }\n    if (!resp.ok) throw new Error(`Fetch failed ${resp.status} for ${url}`);\n    entry!.etag = resp.headers.get('ETag');\n    const json = await resp.json();\n    entry!.data = json;\n    entry!.lastFetched = Date.now();\n    return json as T;\n  })();\n  try {\n    return await entry.promise;\n  } finally {\n    if (strategy === 'stale-while-revalidate') {\n      entry.promise = undefined; // allow background refreshes next time\n    }\n  }\n}\n\n// Utility to clear cache (useful in dev / hot reload) ‚Äì preserves structure\nexport const clearDataCache = () => cache.clear();\n\n// Manual refetch utility (force network)\nexport const refetchJSON = async <T>(path: string) => fetchJSON<T>(path, { force: true, strategy: 'network-first' });\n",
  "utils/href.ts": "/**\n * Safe href processing utility to prevent [object Object] URLs\n * \n * This utility handles the common Next.js Link href patterns and ensures\n * that UrlObjects are passed through correctly while preventing string\n * coercion that results in \"[object Object]\" URLs.\n */\n\nimport { UrlObject } from 'url';\n\nexport type HrefType = string | UrlObject;\n\n/**\n * Safely processes an href value for use with Next.js Link component\n * \n * @param href - The href value to process (string, UrlObject, or unknown)\n * @param fallback - Fallback URL to use if href is invalid (default: '/')\n * @returns A safe href value that can be used with Next.js Link\n */\nexport function sanitizeHref(href: unknown, fallback: string = '/'): HrefType {\n  // Handle string hrefs\n  if (typeof href === 'string') {\n    // Handle empty strings\n    if (href === '') {\n      return fallback;\n    }\n    // Check for corrupted [object Object] strings\n    if (href.includes('[object Object]')) {\n      console.warn('üö® Detected corrupted href string:', href);\n      return fallback;\n    }\n    return href;\n  }\n  \n  // Handle valid Next.js UrlObject\n  if (href && typeof href === 'object' && 'pathname' in href) {\n    return href as UrlObject;\n  }\n  \n  // Handle legacy href objects with .href property\n  if (href && typeof href === 'object' && 'href' in href && typeof (href as any).href === 'string') {\n    const hrefValue = (href as any).href;\n    if (hrefValue.includes('[object Object]')) {\n      console.warn('üö® Detected corrupted href.href property:', href);\n      return fallback;\n    }\n    return hrefValue;\n  }\n  \n  // Handle null/undefined\n  if (!href) {\n    return fallback;\n  }\n  \n  // Handle invalid/unexpected types\n  console.warn('üö® Invalid href type detected:', typeof href, href);\n  return fallback;\n}\n\n/**\n * Creates a safe key for React components using href values\n * Avoids the String(href) pattern that causes [object Object] issues\n * \n * @param href - The href value to create a key from\n * @param index - Optional index to use as fallback\n * @returns A safe string key for React components\n */\nexport function createHrefKey(href: unknown, index?: number): string {\n  if (typeof href === 'string') {\n    if (href.includes('[object Object]')) {\n      return `corrupted-href-${index || Date.now()}`;\n    }\n    return href;\n  }\n  \n  if (href && typeof href === 'object' && 'pathname' in href) {\n    const urlObj = href as UrlObject;\n    const query = urlObj.query ? JSON.stringify(urlObj.query) : '';\n    const hash = urlObj.hash || '';\n    return `${urlObj.pathname}${query}${hash}`;\n  }\n  \n  if (href && typeof href === 'object' && 'href' in href) {\n    const hrefValue = (href as any).href;\n    if (typeof hrefValue === 'string' && !hrefValue.includes('[object Object]')) {\n      return hrefValue;\n    }\n  }\n  \n  return `unknown-href-${index || Date.now()}`;\n}\n\n/**\n * Validates if an href value is safe to use\n * \n * @param href - The href value to validate\n * @returns true if href is safe to use, false otherwise\n */\nexport function isValidHref(href: unknown): boolean {\n  if (typeof href === 'string') {\n    return !href.includes('[object Object]');\n  }\n  \n  if (href && typeof href === 'object' && 'pathname' in href) {\n    return typeof (href as any).pathname === 'string';\n  }\n  \n  if (href && typeof href === 'object' && 'href' in href) {\n    const hrefValue = (href as any).href;\n    return typeof hrefValue === 'string' && !hrefValue.includes('[object Object]');\n  }\n  \n  return false;\n}\n\n/**\n * Development-only function to log href processing issues\n * Only runs in development mode to avoid production console spam\n */\nexport function logHrefIssue(message: string, href: unknown, context?: string): void {\n  if (process.env.NODE_ENV === 'development') {\n    console.warn(`üîó Href Issue ${context ? `[${context}]` : ''}: ${message}`, href);\n  }\n}\n",
  "hooks/useParsedData.ts": "\"use client\";\nimport { useEffect, useState } from 'react';\nimport type { ZodSchema } from 'zod';\nimport { fetchJSON } from '@/lib/dataLoader';\n\nexport function useParsedData<T>(path: string, schema: ZodSchema<T>) {\n  const [data, setData] = useState<T | null>(null);\n  const [error, setError] = useState<Error | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    let alive = true;\n    setLoading(true);\n    fetchJSON<T>(path)\n      .then((d) => {\n        if (path === 'nav.json') {\n          console.log('Nav data loaded:', JSON.stringify(d, null, 2));\n        }\n        const parsed = schema.safeParse(d);\n        if (!parsed.success) throw new Error('Invalid schema for ' + path + ': ' + JSON.stringify(parsed.error.flatten()));\n        if (alive) setData(parsed.data);\n      })\n      .catch((e) => { if (alive) setError(e as Error); })\n      .finally(() => { if (alive) setLoading(false); });\n    return () => { alive = false; };\n  }, [path, schema]);\n\n  return { data, error, loading };\n}\n",
  "hooks/useContent.ts": "\"use client\";\nimport { useEffect, useState } from 'react';\nimport { ContentSchema, type Content } from '@/src/lib/data/schemas';\nimport { fetchWithResilience } from '@/src/lib/data/fetchWithResilience';\n\ntype UseContentResult = {\n  data: Content | null;\n  error: Error | null;\n  loading: boolean;\n  refetch: () => Promise<void>;\n};\n\nasync function fetchContent(): Promise<Content> {\n  const res = await fetchWithResilience('/api/content', {\n    headers: { accept: 'application/json' },\n    cache: 'no-store',\n  });\n  if (!res.ok) {\n    const text = await res.text().catch(() => '');\n    throw new Error(`Content fetch failed: ${res.status} ${res.statusText} ${text}`);\n  }\n  const json = await res.json();\n  // Handle standardized response shape or raw content fallback\n  const payload = (json && json.status === 'success' && json.data) ? json.data : json;\n  return ContentSchema.parse(payload);\n}\n\n// Hook for loading complete content data (unwraps standardized API shape)\nexport function useContent(): UseContentResult {\n  const [data, setData] = useState<Content | null>(null);\n  const [error, setError] = useState<Error | null>(null);\n  const [loading, setLoading] = useState<boolean>(true);\n\n  useEffect(() => {\n    let alive = true;\n    setLoading(true);\n    fetchContent()\n      .then((c) => { if (alive) setData(c); })\n      .catch((e) => { if (alive) setError(e as Error); })\n      .finally(() => { if (alive) setLoading(false); });\n    return () => { alive = false; };\n  }, []);\n\n  const refetch = async () => {\n    setLoading(true);\n    try {\n      const c = await fetchContent();\n      setData(c);\n    } catch (e: any) {\n      setError(e);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return { data, error, loading, refetch };\n}\n\n// Hook for loading specific page content\nexport function usePageContent(pageName: keyof Content['pages']) {\n  const { data: content, error, loading, refetch } = useContent();\n  const pageData = content?.pages?.[pageName];\n  return { data: pageData, error, loading, refetch };\n}\n\n// Hook for loading global content (navigation, UI, etc.)\nexport function useGlobalContent() {\n  const { data: content, error, loading, refetch } = useContent();\n  const globalData = content?.global;\n  return { data: globalData, error, loading, refetch };\n}\n\n// Hook for component-specific content\nexport function useComponentContent(componentName: keyof Content['components']) {\n  const { data: content, error, loading, refetch } = useContent();\n  const componentData = content?.components?.[componentName];\n  return { data: componentData, error, loading, refetch };\n}\n\n// Utility hook for getting content with fallbacks\nexport function useContentWithFallback<T>(path: string, fallback: T): {\n  data: T;\n  error: Error | null;\n  loading: boolean;\n  refetch: () => Promise<void>;\n} {\n  const { data: content, error, loading, refetch } = useContent();\n  const getValue = (obj: any, path: string): T => path.split('.').reduce((curr, key) => curr?.[key], obj) ?? fallback;\n  const data = content ? getValue(content, path) : fallback;\n  return { data, error, loading, refetch };\n}\n",
  "lib/schemas.ts": "import { z } from 'zod';\n\nexport const ProjectSchema = z.object({\n  id: z.string(),\n  title: z.string(),\n  description: z.string(),\n  tags: z.array(z.string()),\n  url: z.string().url().optional(),\n});\n\nexport const SiteDataSchema = z.object({\n  version: z.number(),\n  projects: z.array(ProjectSchema),\n});\n\nexport const NavLinkSchema = z.object({\n  href: z.string(),\n  label: z.string(),\n});\n\nexport const NavDataSchema = z.object({\n  links: z.array(NavLinkSchema),\n});\n\nexport const HomeDataSchema = z.object({\n  heroHeadline: z.string(),\n  heroSubheadline: z.string(),\n  heroCtaLabel: z.string(),\n  heroImage: z.string().url(),\n});\n\nexport const FooterLinkSchema = z.object({\n  href: z.string(),\n  label: z.string(),\n  external: z.boolean().optional(),\n});\n\nexport const FooterSectionSchema = z.object({\n  title: z.string(),\n  links: z.array(FooterLinkSchema),\n});\n\nexport const FooterDataSchema = z.object({\n  sections: z.array(FooterSectionSchema),\n});\n\nexport const MarketingDataSchema = z.object({\n  buttons: z.record(z.string(), z.string()),\n});\n\nexport type SiteDataParsed = z.infer<typeof SiteDataSchema>;\nexport type NavDataParsed = z.infer<typeof NavDataSchema>;\nexport type HomeDataParsed = z.infer<typeof HomeDataSchema>;\nexport type FooterDataParsed = z.infer<typeof FooterDataSchema>;\nexport type MarketingDataParsed = z.infer<typeof MarketingDataSchema>;\n",
  "src/lib/data/fetchWithResilience.ts": "export interface ResilientOptions {\n  tries?: number; // total attempts\n  timeoutMs?: number; // per-attempt timeout\n  baseBackoffMs?: number; // base delay for backoff\n}\n\nconst defaultRetryConfig: Required<ResilientOptions> = {\n  tries: 3,\n  timeoutMs: 10000,\n  baseBackoffMs: 100\n};\n\n/**\n * Resilient fetch with timeout, retries (429/5xx aware), and exponential backoff with jitter.\n * Suitable for client-side hooks; preserves Response for caller to parse.\n */\nexport async function fetchWithResilience(\n  url: string | URL,\n  init?: RequestInit,\n  retryConfig?: ResilientOptions\n): Promise<Response> {\n  // Validate URL to prevent [object Object] issues\n  if (typeof url === 'object' && !(url instanceof URL)) {\n    console.error('fetchWithResilience: Invalid URL object passed:', url);\n    throw new Error(`Invalid URL object: ${JSON.stringify(url)}`);\n  }\n  \n  if (typeof url === 'string' && url.includes('[object ')) {\n    console.error('fetchWithResilience: Serialized object found in URL:', url);\n    throw new Error(`Invalid URL contains serialized object: ${url}`);\n  }\n\n  const config = { ...defaultRetryConfig, ...retryConfig };\n  let lastError: Error;\n\n  for (let attempt = 0; attempt < config.tries; attempt++) {\n    const controller = new AbortController();\n    const timeout = setTimeout(() => controller.abort(), config.timeoutMs);\n\n    try {\n      const res = await fetch(url, { ...init, signal: init?.signal ?? controller.signal });\n      clearTimeout(timeout);\n      return res;\n    } catch (error) {\n      clearTimeout(timeout);\n      lastError = error as Error;\n      \n      if (attempt < config.tries - 1) {\n        const backoff = config.baseBackoffMs * Math.pow(2, attempt);\n        await new Promise((resolve) => setTimeout(resolve, backoff));\n      }\n    }\n  }\n\n  throw lastError!;\n}\n\n",
  "src/lib/data/schemas.ts": "import { z } from \"zod\";\n\nexport const DietarySchema = z.object({\n  vegetarian: z.boolean().optional(),\n  vegan: z.boolean().optional(),\n  glutenFree: z.boolean().optional(),\n  spicy: z.boolean().optional(),\n});\n\nexport const MoneySchema = z.object({\n  amount: z.number().nonnegative(),\n  currency: z.enum([\"USD\", \"EUR\", \"GBP\"]).default(\"GBP\"),\n});\n\nexport const MenuItemSchema = z.object({\n  id: z.string().min(1),\n  name: z.string().min(1),\n  description: z.string().default(\"\"),\n  price: MoneySchema,\n  available: z.boolean().default(true),\n  dietary: DietarySchema.default({}),\n  tags: z.array(z.string()).default([]),\n});\n\nexport const MenuSectionSchema = z.object({\n  id: z.string(),\n  name: z.string(),\n  description: z.string().optional(),\n  items: z.array(MenuItemSchema),\n});\n\nexport const MenuSchema = z.object({\n  updatedAt: z.string(),\n  sections: z.array(MenuSectionSchema),\n});\n\nexport const RestaurantSchema = z.object({\n  name: z.string(),\n  phone: z.string(),\n  email: z.string(),\n  address: z.object({\n    street: z.string(),\n    city: z.string(),\n    state: z.string(),\n    zip: z.string(),\n  }),\n  hours: z.union([\n    z.record(z.string(), z.string()), // Legacy format: {\"Mon-Thu\": \"12:00-23:00\"}\n    z.object({\n      kitchen: z.record(z.string(), z.string()),\n      bar: z.record(z.string(), z.string()),\n    }), // New detailed format: {kitchen: {monday: \"12:00-15:00,17:00-22:00\"}, bar: {monday: \"12:00-22:00\"}}\n  ]),\n});\n\nexport const MarketingSchema = z.object({\n  hero: z.object({ title: z.string(), subtitle: z.string().optional() }),\n  promos: z\n    .array(z.object({ id: z.string(), title: z.string(), body: z.string() }))\n    .default([]),\n  seo: z.object({ title: z.string(), description: z.string() }).optional(),\n  buttons: z.record(z.string(), z.string()).default({}),\n});\n\nexport const ConfigSchema = z.object({\n  env: z.enum([\"app\", \"dev\", \"staging\", \"prod\"]).default(\"app\"),\n  featureFlags: z.record(z.string(), z.boolean()).default({}),\n  api: z\n    .object({\n      baseUrl: z.string().url().optional(),\n  menuEndpoint: z.string().url().optional(),\n  marketingEndpoint: z.string().url().optional(),\n  restaurantEndpoint: z.string().url().optional(),\n  contentEndpoint: z.string().url().optional(),\n    })\n    .default({}),\n  cms: z.object({ enabled: z.boolean().default(false) }).default({ enabled: false }),\n  metadata: z\n    .object({\n      appName: z.string().default(\"Old Crown\"),\n      domainName: z.string().default(\"localhost\"),\n    })\n    .default({ appName: \"Old Crown\", domainName: \"localhost\" }),\n});\n\n// Content Management Schemas\nexport const LinkSchema = z.object({\n  href: z.string(),\n  label: z.string(),\n  external: z.boolean().optional(),\n});\n\nexport const SocialMediaSchema = z.object({\n  url: z.string().url(),\n  label: z.string(),\n});\n\nexport const NavigationSchema = z.object({\n  header: z.object({\n    links: z.array(LinkSchema),\n  }),\n  footer: z.object({\n    sections: z.array(z.object({\n      title: z.string(),\n      links: z.array(LinkSchema),\n    })),\n    copyright: z.string(),\n    socialMedia: z.record(z.string(), SocialMediaSchema).optional(),\n  }),\n  breadcrumbs: z.object({\n    home: z.string(),\n    separator: z.string(),\n  }),\n});\n\nexport const UISchema = z.object({\n  buttons: z.record(z.string(), z.string()),\n  labels: z.record(z.string(), z.string()),\n  messages: z.record(z.string(), z.string()),\n  placeholders: z.record(z.string(), z.string()),\n});\n\nexport const AccessibilitySchema = z.object({\n  ariaLabels: z.record(z.string(), z.string()),\n  altTexts: z.record(z.string(), z.string()),\n  descriptions: z.record(z.string(), z.string()),\n});\n\nexport const HeroSchema = z.object({\n  title: z.string(),\n  subtitle: z.string().optional(),\n  description: z.string().optional(),\n  cta: z.object({\n    primary: z.string(),\n    secondary: z.string().optional(),\n  }).optional(),\n});\n\nexport const FeatureItemSchema = z.object({\n  icon: z.string().optional(),\n  title: z.string().optional(),\n  description: z.string().optional(),\n  text: z.string().optional(),\n});\n\nexport const CTAButtonSchema = z.object({\n  text: z.string(),\n  href: z.string(),\n  variant: z.string().optional(),\n  key: z.string().optional(),\n  external: z.boolean().optional(),\n  ariaLabel: z.string().optional(),\n});\n\nexport const SlideImageSchema = z.object({\n  primary: z.string(),\n  fallback: z.string().optional(),\n  alt: z.string().optional(),\n  width: z.number().nullable().optional(),\n  height: z.number().nullable().optional(),\n});\n\nexport const SlideCTASchema = z.object({\n  bookUrl: z.string().optional(),\n  callTel: z.string().optional(),\n  menuUrl: z.string().optional(),\n  secondaryUrl: z.string().optional(),\n});\n\nexport const SlideSchema = z.object({\n  id: z.string(),\n  required: z.boolean().optional(),\n  image: SlideImageSchema,\n  alt: z.string().optional(),\n  eyebrow: z.string().optional(),\n  headline: z.string().optional(),\n  copy: z.string().optional(),\n  badges: z.array(z.string()).optional(),\n  ctas: SlideCTASchema.optional(),\n});\n\nexport const SlideshowSettingsSchema = z.object({\n  autoplay: z.boolean().optional(),\n  intervalMs: z.number().optional(),\n  sessionSize: z.number().optional(),\n});\n\nexport const SlideshowContentSchema = z.object({\n  settings: SlideshowSettingsSchema.default({}),\n  slides: z.array(SlideSchema),\n});\n\nexport const PressFeatureSchema = z.object({\n  label: z.string().optional(),\n  eyebrow: z.string().optional(),\n  title: z.string().optional(),\n  summary: z.string().optional(),\n  quote: z.string().optional(),\n  quoteAttribution: z.string().optional(),\n  cta: z.object({\n    text: z.string().optional(),\n    href: z.string().optional(),\n  }).optional(),\n});\n\nexport const HomeCTASectionSchema = z.object({\n  headline: z.string(),\n  description: z.string(),\n  buttons: z.array(CTAButtonSchema),\n});\n\nexport const PageSeoSchema = z.object({\n  title: z.string().optional(),\n  description: z.string().optional(),\n  schemas: z.array(z.record(z.string(), z.any())).optional(),\n}).passthrough();\n\nexport const QuickLinkSchema = z.object({\n  title: z.string(),\n  description: z.string(),\n  link: z.string(),\n  linkText: z.string(),\n});\n\nexport const TestimonialSchema = z.object({\n  name: z.string(),\n  text: z.string(),\n  rating: z.number().min(1).max(5).optional(),\n  location: z.string().optional(),\n  image: z.string().optional(),\n});\n\nexport const FAQItemSchema = z.object({\n  question: z.string(),\n  answer: z.string(),\n});\n\nexport const EventSchema = z.object({\n  title: z.string(),\n  description: z.string(),\n  frequency: z.string(),\n  icon: z.string().optional(),\n  // Optional ISO dates for specific scheduled events\n  startDate: z.string().optional(),\n  endDate: z.string().optional(),\n});\n\nexport const FormValidationSchema = z.object({\n  required: z.string(),\n  email: z.string(),\n  phone: z.string(),\n  minLength: z.string(),\n  maxLength: z.string(),\n});\n\nexport const APIErrorsSchema = z.object({\n  menu: z.object({\n    loadFailed: z.string(),\n    notFound: z.string(),\n  }),\n  restaurant: z.object({\n    loadFailed: z.string(),\n    notFound: z.string(),\n  }),\n  marketing: z.object({\n    loadFailed: z.string(),\n    notFound: z.string(),\n  }),\n  config: z.object({\n    loadFailed: z.string(),\n    notFound: z.string(),\n  }),\n  validation: z.record(z.string(), z.string()),\n  auth: z.record(z.string(), z.string()),\n  payment: z.record(z.string(), z.string()),\n});\n\nexport const ContentSchema = z.object({\n  global: z.object({\n    site: z.object({\n      name: z.string(),\n      title: z.string(),\n      description: z.string(),\n      keywords: z.array(z.string()),\n      branding: z.object({\n        tagline: z.string(),\n        slogan: z.string(),\n      }),\n    }),\n    navigation: NavigationSchema,\n    ui: UISchema,\n    accessibility: AccessibilitySchema,\n  }),\n  pages: z.object({\n    home: z.object({\n      hero: HeroSchema,\n      sections: z.object({\n        features: z.object({\n          title: z.string(),\n          items: z.array(FeatureItemSchema),\n        }),\n        quickLinks: z.array(QuickLinkSchema),\n        pressFeature: PressFeatureSchema.optional(),\n        cta: HomeCTASectionSchema.optional(),\n      }).passthrough(),\n      seo: PageSeoSchema.optional(),\n    }),\n    about: z.object({\n      hero: HeroSchema,\n      story: z.object({\n        title: z.string(),\n        introduction: z.string(),\n        timeline: z.array(z.object({\n          period: z.string(),\n          title: z.string(),\n          description: z.string(),\n        })),\n      }),\n      cta: z.object({\n        title: z.string(),\n        description: z.string(),\n        button: z.string(),\n        contact: z.object({\n          address: z.string(),\n          hours: z.string(),\n        }),\n      }),\n    }),\n    contact: z.object({\n      hero: HeroSchema,\n      contactInfo: z.record(z.string(), z.any()).optional(),\n      hours: z.record(z.string(), z.any()).optional(),\n      features: z.object({\n        title: z.string(),\n        items: z.array(FeatureItemSchema),\n      }).optional(),\n    }),\n    events: z.object({\n      hero: HeroSchema,\n      regularEvents: z.array(EventSchema),\n      // Lightweight SEO-oriented events list (e.g. \"Birthday / anniversary\")\n      seoEvents: z.array(z.string()).optional(),\n      contact: z.object({\n        title: z.string(),\n        description: z.string(),\n        phone: z.string(),\n        email: z.string(),\n      }),\n    }),\n    menu: z.object({\n      hero: HeroSchema.extend({\n        cta: z.object({\n          book: z.string(),\n          order: z.string(),\n        }),\n      }),\n      sections: z.object({\n        description: z.string(),\n        allergenNotice: z.string(),\n      }),\n    }),\n    signin: z.record(z.string(), z.any()).optional(),\n    dashboard: z.record(z.string(), z.any()).optional(),\n    offline: z.record(z.string(), z.any()),\n    notFound: z.record(z.string(), z.any()),\n  }),\n  components: z.object({\n    testimonials: z.object({\n      title: z.string(),\n      subtitle: z.string(),\n      items: z.array(TestimonialSchema),\n    }).optional(),\n    faq: z.object({\n      title: z.string(),\n      subtitle: z.string(),\n      items: z.array(FAQItemSchema),\n    }).optional(),\n    menuHighlights: z.record(z.string(), z.any()).optional(),\n    slideshow: SlideshowContentSchema.optional(),\n  }),\n  forms: z.object({\n    validation: FormValidationSchema,\n    messages: z.record(z.string(), z.string()),\n    labels: z.record(z.string(), z.string()),\n  }),\n  api: z.object({\n    messages: z.record(z.string(), z.string()),\n    errors: APIErrorsSchema,\n  }),\n  legal: z.object({\n    terms: z.object({\n      title: z.string(),\n      effectiveDate: z.string(),\n      contact: z.string(),\n    }),\n    privacy: z.object({\n      title: z.string(),\n      effectiveDate: z.string(),\n      contact: z.string(),\n    }),\n  }),\n});\n\nexport type Menu = z.infer<typeof MenuSchema>;\nexport type Restaurant = z.infer<typeof RestaurantSchema>;\nexport type Marketing = z.infer<typeof MarketingSchema>;\nexport type AppConfig = z.infer<typeof ConfigSchema>;\nexport type Content = z.infer<typeof ContentSchema>;\nexport type NavigationType = z.infer<typeof NavigationSchema>;\nexport type UIType = z.infer<typeof UISchema>;\nexport type HeroType = z.infer<typeof HeroSchema>;\nexport type TestimonialType = z.infer<typeof TestimonialSchema>;\nexport type FAQItemType = z.infer<typeof FAQItemSchema>;\nexport type EventType = z.infer<typeof EventSchema>;\n",
  "src/lib/data/server-loader.ts": "// Ensure this module only runs on the server\nimport 'server-only';\n\n// Server-side only imports\nimport fs from \"fs/promises\";\nimport path from \"path\";\nimport {\n  MenuSchema,\n  MarketingSchema,\n  RestaurantSchema,\n  ConfigSchema,\n  ContentSchema,\n  type Menu,\n  type Marketing,\n  type Restaurant,\n  type AppConfig,\n  type Content,\n} from \"./schemas\";\nimport { resolveEnv, resolveContentEnvChain, type AppEnv } from \"./env\";\nimport { globalCache, createCacheKey } from \"./cache\";\nimport type { ZodTypeAny } from \"zod\";\n\n// Server-side file reading function\nasync function readJson<T>(p: string, schema: any, name: string): Promise<T> {\n  const raw = await fs.readFile(p, \"utf8\");\n  const parsed = JSON.parse(raw);\n  return schema.parse(parsed) as T;\n}\n\nasync function readJsonRaw(p: string): Promise<any> {\n  const raw = await fs.readFile(p, \"utf8\");\n  return JSON.parse(raw);\n}\n\nasync function readJsonIfExists(p: string): Promise<any | null> {\n  try {\n    return await readJsonRaw(p);\n  } catch (error: any) {\n    if (error?.code === 'ENOENT') {\n      return null;\n    }\n    throw error;\n  }\n}\n\nfunction configPath(file: string) {\n  return path.join(process.cwd(), \"config\", file);\n}\n\nfunction cloneValue<T>(value: T): T {\n  if (Array.isArray(value)) {\n    return value.map((item) => cloneValue(item)) as unknown as T;\n  }\n  if (value && typeof value === 'object') {\n    const result: Record<string, any> = {};\n    for (const [key, val] of Object.entries(value)) {\n      result[key] = cloneValue(val);\n    }\n    return result as T;\n  }\n  return value;\n}\n\nfunction mergeContent(base: any, override: any): any {\n  if (override === undefined || override === null) {\n    return cloneValue(base);\n  }\n  if (base === undefined || base === null) {\n    return cloneValue(override);\n  }\n\n  if (Array.isArray(override)) {\n    // Environment overrides replace arrays wholesale\n    return cloneValue(override);\n  }\n\n  if (Array.isArray(base)) {\n    return cloneValue(override);\n  }\n\n  if (typeof base === 'object' && typeof override === 'object') {\n    const result: Record<string, any> = { ...cloneValue(base) };\n    for (const key of Object.keys(override)) {\n      result[key] = mergeContent((result as any)[key], override[key]);\n    }\n    return result;\n  }\n\n  return cloneValue(override);\n}\n\nasync function loadContentFromFilesystem(env: AppEnv): Promise<Content> {\n  const basePath = configPath(\"content.json\");\n  let merged = await readJsonRaw(basePath);\n\n  const envChain = resolveContentEnvChain(env);\n\n  for (const envName of envChain) {\n    const overridePath = path.join(process.cwd(), \"data\", envName, \"content.json\");\n    try {\n      const override = await readJsonIfExists(overridePath);\n      if (override) {\n        merged = mergeContent(merged, override);\n      }\n    } catch (error) {\n      console.warn(`Failed to load content override for ${envName}:`, error);\n    }\n  }\n\n  return ContentSchema.parse(merged) as Content;\n}\n\n// Server-side data loading functions\nexport async function getContentData(env: AppEnv = resolveEnv()): Promise<Content> {\n  const envChain = resolveContentEnvChain(env);\n  const cacheKey = createCacheKey('content', env, { chain: envChain.join('>') });\n  \n  return globalCache.get(cacheKey, async () => {\n    return loadContentFromFilesystem(env);\n  }, {\n    ttl: getContentCacheTTL(env),\n    enableCompression: process.env.NODE_ENV === 'production'\n  });\n}\n\nexport async function getContentDataOptimized(env: AppEnv = resolveEnv()): Promise<Content> {\n  const envChain = resolveContentEnvChain(env);\n  const cacheKey = createCacheKey('content-optimized', env, { chain: envChain.join('>') });\n  \n  return globalCache.get(cacheKey, async () => {\n    return loadContentFromFilesystem(env);\n  }, {\n    ttl: getContentCacheTTL(env),\n    enableCompression: process.env.NODE_ENV === 'production'\n  });\n}\n\nexport async function getConfigData(env: AppEnv = resolveEnv()): Promise<AppConfig> {\n  const cacheKey = createCacheKey('config', env);\n  \n  return globalCache.get(cacheKey, async () => {\n    // Use main config.json directly\n    return readJson<AppConfig>(configPath(\"config.json\"), ConfigSchema, \"config\");\n  }, {\n    ttl: getConfigCacheTTL(env)\n  });\n}\n\nexport async function getRestaurantInfo(env: AppEnv = resolveEnv()): Promise<Restaurant> {\n  return readJson<Restaurant>(\n    configPath(\"restaurant.json\"),\n    RestaurantSchema,\n    \"restaurant\"\n  );\n}\n\nexport async function getMarketingContent(env: AppEnv = resolveEnv()): Promise<Marketing> {\n  return readJson<Marketing>(\n    configPath(\"marketing.json\"),\n    MarketingSchema,\n    \"marketing\"\n  );\n}\n\n// Smart loaders with API fallback\nexport async function getContentSmart(env: AppEnv = resolveEnv()): Promise<Content> {\n  const cacheKey = createCacheKey('content-smart', env);\n  \n  return globalCache.get(cacheKey, async () => {\n    try {\n      const cfg = await getConfigData(env);\n      const cmsOn = cfg.cms?.enabled || cfg.featureFlags?.[\"cms\"];\n      const endpoint = cfg.api?.contentEndpoint || cfg.api?.baseUrl ? `${cfg.api.baseUrl}/api/content` : undefined;\n      \n      if (cmsOn && endpoint) {\n        try {\n          // Try API first\n          const { fetchWithResilience } = await import('./fetchWithResilience');\n          const response = await fetchWithResilience(endpoint, { \n            cache: 'no-store'\n          }, { tries: 2, timeoutMs: 3000, baseBackoffMs: 200 });\n          if (response.ok) {\n            const content = await response.json();\n            return ContentSchema.parse(content);\n          }\n        } catch (apiError) {\n          console.warn('API content loading failed, falling back to filesystem:', apiError);\n        }\n      }\n    } catch (configError) {\n      console.warn('Config loading failed, using filesystem content:', configError);\n    }\n    \n    return getContentDataOptimized(env);\n  }, {\n    ttl: getContentCacheTTL(env),\n    enableCompression: process.env.NODE_ENV === 'production'\n  });\n}\n\nexport async function getMenuData(env: AppEnv = resolveEnv()): Promise<Menu> {\n  const cacheKey = createCacheKey('menu', env);\n  \n  return globalCache.get(cacheKey, async () => {\n    return loadMenuFromFileSystem();\n  }, {\n    ttl: getMenuCacheTTL(env),\n    enableCompression: true\n  });\n}\n\nexport async function getMenuDataOptimized(priorityCategory?: string, env: AppEnv = resolveEnv()): Promise<Menu> {\n  const cacheKey = createCacheKey(`menu-optimized-${priorityCategory || 'all'}`, env);\n  \n  return globalCache.get(cacheKey, async () => {\n    return loadMenuFromFileSystemOptimized(priorityCategory);\n  }, {\n    ttl: getMenuCacheTTL(env),\n    enableCompression: true\n  });\n}\n\nasync function loadMenuFromFileSystemOptimized(priorityCategory?: string): Promise<Menu> {\n  // Load from modular menu files in /menu directory with optimized concurrent loading\n  const modularMenuDir = path.join(process.cwd(), \"menu\");\n  \n  const categories = [\n    { id: \"starters\", name: \"Starters\" },\n    { id: \"mixed_grills\", name: \"Mixed Grills\" },\n    { id: \"speciality\", name: \"Speciality Dishes\" },\n    { id: \"authentic_dishes\", name: \"Authentic Dishes\" },\n    { id: \"naans\", name: \"Naans\" },\n    { id: \"fries\", name: \"Fries\" },\n    { id: \"pub_grub\", name: \"Pub Grub\" },\n    { id: \"rice\", name: \"Rice\" },\n    { id: \"pub_classics\", name: \"Pub Classic\" },\n    { id: \"salads\", name: \"Salads\" },\n    { id: \"sides\", name: \"Sides\" },\n    { id: \"kids_menu\", name: \"Kids\" },\n    { id: \"desserts\", name: \"Desserts\" }\n  ];\n  \n  // Prioritize loading order - priority category first\n  const orderedCategories = priorityCategory\n    ? [\n        ...categories.filter(cat => cat.id === priorityCategory),\n        ...categories.filter(cat => cat.id !== priorityCategory)\n      ]\n    : categories;\n  \n  // Load categories concurrently with Promise.allSettled for better error handling\n  const categoryPromises = orderedCategories.map(async (cat) => {\n    const filePath = path.join(modularMenuDir, `${cat.id}.json`);\n    try {\n      const raw = await fs.readFile(filePath, \"utf8\");\n      const items = JSON.parse(raw);\n      \n      // Transform items to match expected schema structure with optimizations\n      const transformedItems = items.map((item: any, index: number) => {\n        const dietary = {\n          vegetarian: item.labels?.includes(\"veg\") || false,\n          glutenFree: item.labels?.includes(\"GF\") || false\n        };\n        \n        return {\n          id: item.id || `${cat.id}-${index + 1}`,\n          name: item.name,\n          description: item.description || \"\",\n          price: item.price,\n          available: item.available !== false,\n          dietary,\n          tags: item.labels?.filter((label: string) => !['veg', 'GF'].includes(label)) || [],\n          // Pre-compute search terms for faster client-side filtering\n          searchTerms: `${item.name} ${item.description || ''} ${item.labels?.join(' ') || ''}`.toLowerCase()\n        };\n      });\n      \n      return { \n        id: cat.id, \n        name: cat.name, \n        items: transformedItems,\n        // Pre-compute section metadata\n        itemCount: transformedItems.length,\n        hasVegetarian: transformedItems.some((item: any) => item.dietary.vegetarian),\n        hasGlutenFree: transformedItems.some((item: any) => item.dietary.glutenFree),\n        priceRange: transformedItems.length > 0 ? {\n          min: Math.min(...transformedItems.map((item: any) => item.price?.amount || 0)),\n          max: Math.max(...transformedItems.map((item: any) => item.price?.amount || 0))\n        } : null\n      };\n    } catch (e) {\n      console.warn(`Warning: Could not load menu category file ${cat.id}.json:`, e);\n      return null;\n    }\n  });\n  \n  const results = await Promise.allSettled(categoryPromises);\n  const sections = results\n    .filter((result): result is PromiseFulfilledResult<any> => \n      result.status === 'fulfilled' && result.value !== null\n    )\n    .map(result => result.value);\n  \n  if (sections.length === 0) {\n    throw new Error('No menu data could be loaded from /menu directory');\n  }\n  \n  return {\n    updatedAt: new Date().toISOString(),\n    sections\n  };\n}\n\nasync function loadMenuFromFileSystem(): Promise<Menu> {\n  // Load from modular menu files in /menu directory\n  const modularMenuDir = path.join(process.cwd(), \"menu\");\n  \n  const categories = [\n    { id: \"starters\", name: \"Starters\" },\n    { id: \"mixed_grills\", name: \"Mixed Grills\" },\n    { id: \"speciality\", name: \"Speciality Dishes\" },\n    { id: \"authentic_dishes\", name: \"Authentic Dishes\" },\n    { id: \"naans\", name: \"Naans\" },\n    { id: \"fries\", name: \"Fries\" },\n    { id: \"pub_grub\", name: \"Pub Grub\" },\n    { id: \"rice\", name: \"Rice\" },\n    { id: \"pub_classics\", name: \"Pub Classic\" },\n    { id: \"salads\", name: \"Salads\" },\n    { id: \"sides\", name: \"Sides\" },\n    { id: \"kids_menu\", name: \"Kids\" },\n    { id: \"desserts\", name: \"Desserts\" }\n  ];\n  \n  const sections = [];\n  for (const cat of categories) {\n    const filePath = path.join(modularMenuDir, `${cat.id}.json`);\n    try {\n      const raw = await fs.readFile(filePath, \"utf8\");\n      const items = JSON.parse(raw);\n      \n      // Transform items to match expected schema structure\n      const transformedItems = items.map((item: any, index: number) => ({\n        id: item.id || `${cat.id}-${index + 1}`,\n        name: item.name,\n        description: item.description || \"\",\n        price: item.price,\n        available: item.available !== false,\n        dietary: {\n          vegetarian: item.labels?.includes(\"veg\") || false,\n          glutenFree: item.labels?.includes(\"GF\") || false\n        },\n        tags: item.labels?.filter((label: string) => !['veg', 'GF'].includes(label)) || []\n      }));\n      \n      sections.push({ \n        id: cat.id, \n        name: cat.name, \n        items: transformedItems \n      });\n    } catch (e) {\n      console.warn(`Warning: Could not load menu category file ${cat.id}.json:`, e);\n      // Continue with other categories\n    }\n  }\n  \n  if (sections.length === 0) {\n    throw new Error('No menu data could be loaded from /menu directory');\n  }\n  \n  return {\n    updatedAt: new Date().toISOString(),\n    sections\n  };\n}\n\nexport async function getMenuSmart(priorityCategory?: string, env: AppEnv = resolveEnv()): Promise<Menu> {\n  try {\n    const cfg = await getConfigData(env);\n    const cmsOn = cfg.cms?.enabled || cfg.featureFlags?.[\"cms\"];\n    const endpoint = cfg.api?.menuEndpoint;\n    if (cmsOn && endpoint) {\n      try {\n        const { fetchWithResilience } = await import('./fetchWithResilience');\n        const response = await fetchWithResilience(endpoint, { \n          cache: 'no-store'\n        }, { tries: 2, timeoutMs: 3000, baseBackoffMs: 200 });\n        if (response.ok) {\n          const menu = await response.json();\n          return MenuSchema.parse(menu);\n        }\n      } catch {\n        // fall through to fs\n      }\n    }\n  } catch {\n    // ignore config errors; fallback to fs\n  }\n  \n  // Use optimized loader if priority category is specified\n  return priorityCategory \n    ? getMenuDataOptimized(priorityCategory, env)\n    : getMenuData(env);\n}\n\nexport async function getMarketingSmart(env: AppEnv = resolveEnv()): Promise<Marketing> {\n  try {\n    const cfg = await getConfigData(env);\n    const cmsOn = cfg.cms?.enabled || cfg.featureFlags?.[\"cms\"];\n    const endpoint = cfg.api?.marketingEndpoint || cfg.api?.baseUrl ? `${cfg.api.baseUrl}/api/marketing` : undefined;\n    if (cmsOn) {\n      try {\n        const url = endpoint ?? '/api/marketing';\n        const { fetchWithResilience } = await import('./fetchWithResilience');\n        const response = await fetchWithResilience(url, { \n          cache: 'no-store'\n        }, { tries: 2, timeoutMs: 3000, baseBackoffMs: 200 });\n        if (response.ok) {\n          const marketing = await response.json();\n          return MarketingSchema.parse(marketing);\n        }\n      } catch {\n        // fall back\n      }\n    }\n  } catch {\n    // ignore and fall back\n  }\n  return getMarketingContent(env);\n}\n\nexport async function getRestaurantSmart(env: AppEnv = resolveEnv()): Promise<Restaurant> {\n  try {\n    const cfg = await getConfigData(env);\n    const cmsOn = cfg.cms?.enabled || cfg.featureFlags?.[\"cms\"];\n    const endpoint = cfg.api?.restaurantEndpoint || cfg.api?.baseUrl ? `${cfg.api.baseUrl}/api/restaurant` : undefined;\n    if (cmsOn) {\n      try {\n        const url = endpoint ?? '/api/restaurant';\n        const { fetchWithResilience } = await import('./fetchWithResilience');\n        const response = await fetchWithResilience(url, { \n          cache: 'no-store'\n        }, { tries: 2, timeoutMs: 3000, baseBackoffMs: 200 });\n        if (response.ok) {\n          const restaurant = await response.json();\n          return RestaurantSchema.parse(restaurant);\n        }\n      } catch {\n        // fall back\n      }\n    }\n  } catch {\n    // ignore and fall back\n  }\n  return getRestaurantInfo(env);\n}\n\nexport async function preloadCriticalContent(env: AppEnv = resolveEnv()): Promise<void> {\n  const preloadPromises = [\n    globalCache.preload(\n      createCacheKey('content', env),\n      () => getContentDataOptimized(env)\n    ),\n    globalCache.preload(\n      createCacheKey('config', env),\n      () => getConfigData(env)\n    ),\n    globalCache.preload(\n      createCacheKey('menu-optimized-starters', env),\n      () => getMenuDataOptimized('starters', env)\n    ),\n    globalCache.preload(\n      createCacheKey('menu', env),\n      () => getMenuData(env)\n    )\n  ];\n  \n  await Promise.allSettled(preloadPromises);\n}\n\nexport function getCacheStats() {\n  return globalCache.getStats();\n}\n\nexport function optimizeCache() {\n  return globalCache.optimize();\n}\n\nexport function invalidateCache(pattern?: string | RegExp): number {\n  return globalCache.invalidate(pattern);\n}\n\nfunction getContentCacheTTL(env: AppEnv): number {\n  // Use production-optimized caching for single environment\n  return process.env.NODE_ENV === 'production' ? 60 * 60 * 1000 : 60 * 1000; // 1 hour in prod, 1 minute in dev\n}\n\nfunction getConfigCacheTTL(env: AppEnv): number {\n  // Use production-optimized caching for single environment\n  return process.env.NODE_ENV === 'production' ? 30 * 60 * 1000 : 30 * 1000; // 30 minutes in prod, 30 seconds in dev\n}\n\nfunction getMenuCacheTTL(env: AppEnv): number {\n  // Use production-optimized caching for single environment\n  return process.env.NODE_ENV === 'production' ? 2 * 60 * 60 * 1000 : 30 * 1000; // 2 hours in prod, 30 seconds in dev\n}\n\nfunction getRestaurantCacheTTL(env: AppEnv): number {\n  // Use production-optimized caching for single environment\n  return process.env.NODE_ENV === 'production' ? 4 * 60 * 60 * 1000 : 2 * 60 * 1000; // 4 hours in prod, 2 minutes in dev\n}\n",
  "src/lib/data/env.ts": "export type AppEnv = 'app' | 'dev' | 'staging' | 'prod';\nexport type ContentEnv = 'dev' | 'staging' | 'prod';\n\nconst ENV_ALIASES: Record<string, AppEnv> = {\n  app: 'app',\n  prod: 'prod',\n  production: 'prod',\n  main: 'prod',\n  release: 'prod',\n  live: 'prod',\n  staging: 'staging',\n  preview: 'staging',\n  preprod: 'staging',\n  qa: 'staging',\n  test: 'dev',\n  testing: 'dev',\n  ci: 'dev',\n  development: 'dev',\n  dev: 'dev',\n  local: 'dev'\n};\n\nfunction normalizeAppEnv(value?: string | null): AppEnv | null {\n  if (!value) return null;\n  return ENV_ALIASES[value.toLowerCase()] ?? null;\n}\n\n/**\n * Resolve the current application environment.\n * Falls back to 'dev' for local workflows unless explicitly overridden.\n */\nexport function resolveEnv(): AppEnv {\n  const candidates = [\n    process.env.CONTENT_ENV,\n    process.env.NEXT_PUBLIC_CONTENT_ENV,\n    process.env.APP_ENV,\n    process.env.NEXT_PUBLIC_APP_ENV,\n    process.env.VERCEL_ENV\n  ];\n\n  for (const candidate of candidates) {\n    const normalized = normalizeAppEnv(candidate);\n    if (normalized) {\n      // Preserve explicit 'app' usage for backward compatibility\n      if (candidate && candidate.toLowerCase() === 'app') {\n        return 'app';\n      }\n      return normalized;\n    }\n  }\n\n  return 'app';\n}\n\n/**\n * Convert any environment hint into a concrete content environment folder.\n */\nexport function toContentEnv(value?: string | AppEnv | null): ContentEnv | null {\n  if (!value) return null;\n  const normalized =\n    typeof value === 'string' ? normalizeAppEnv(value) : value;\n  if (!normalized) return null;\n  return normalized === 'app' ? 'prod' : normalized;\n}\n\n/**\n * Determine the ordered list of environment folders to consult for content overrides.\n * Later entries have higher precedence and should be merged last.\n */\nexport function resolveContentEnvChain(explicitEnv?: AppEnv): ContentEnv[] {\n  const chain: ContentEnv[] = [];\n  const pushEnv = (value?: string | AppEnv | null) => {\n    const env = toContentEnv(value);\n    if (env && !chain.includes(env)) {\n      chain.push(env);\n    }\n  };\n\n  // Runtime hints (lowest precedence)\n  const runtimeCandidates = [\n    process.env.CONTENT_ENV,\n    process.env.NEXT_PUBLIC_CONTENT_ENV,\n    process.env.APP_ENV,\n    process.env.NEXT_PUBLIC_APP_ENV,\n    process.env.VERCEL_ENV,\n    process.env.NODE_ENV\n  ];\n\n  for (const candidate of runtimeCandidates) {\n    pushEnv(candidate);\n  }\n\n  // Explicit env parameter (highest precedence)\n  if (explicitEnv) {\n    pushEnv(explicitEnv);\n  }\n\n  if (chain.length === 0) {\n    chain.push('dev');\n  }\n\n  return chain;\n}\n",
  "src/lib/data/cache.ts": "/**\n * Performance Cache Manager for Content Loading\n * \n * Provides advanced caching strategies for content data with:\n * - In-memory caching with TTL\n * - Compression support\n * - Cache warming and preloading\n * - Performance metrics tracking\n * - Intelligent cache invalidation\n */\n\nimport { LRUCache } from 'lru-cache';\nimport { gzipSync, gunzipSync } from 'zlib';\nimport type { Content, Menu, Marketing, Restaurant, AppConfig } from './schemas';\nimport type { AppEnv } from './env';\n\ninterface CacheEntry<T> {\n  data: T;\n  compressed?: Buffer;\n  timestamp: number;\n  accessCount: number;\n  lastAccess: number;\n  size: number;\n  etag?: string;\n}\n\ninterface CacheMetrics {\n  hits: number;\n  misses: number;\n  evictions: number;\n  compressionRatio: number;\n  averageLoadTime: number;\n  totalSize: number;\n}\n\ninterface CacheConfig {\n  maxSize: number;\n  ttl: number;\n  enableCompression: boolean;\n  compressionThreshold: number;\n  enableMetrics: boolean;\n  warmupUrls?: string[];\n}\n\nexport class PerformanceCacheManager {\n  private cache: LRUCache<string, CacheEntry<any>>;\n  private metrics: CacheMetrics;\n  private config: CacheConfig;\n  private warmupPromise?: Promise<void>;\n\n  constructor(config: Partial<CacheConfig> = {}) {\n    this.config = {\n      maxSize: 50 * 1024 * 1024, // 50MB default\n      ttl: 5 * 60 * 1000, // 5 minutes default\n      enableCompression: true,\n      compressionThreshold: 1024, // 1KB\n      enableMetrics: true,\n      ...config\n    };\n\n    this.cache = new LRUCache<string, CacheEntry<any>>({\n      max: 100, // max entries\n      maxSize: this.config.maxSize,\n      ttl: this.config.ttl,\n      sizeCalculation: (entry) => entry.size,\n      dispose: (entry) => {\n        if (this.config.enableMetrics) {\n          this.metrics.evictions++;\n          this.metrics.totalSize -= entry.size;\n        }\n      }\n    });\n\n    this.metrics = {\n      hits: 0,\n      misses: 0,\n      evictions: 0,\n      compressionRatio: 0,\n      averageLoadTime: 0,\n      totalSize: 0\n    };\n\n    // Auto-warmup if URLs provided\n    if (this.config.warmupUrls && this.config.warmupUrls.length > 0) {\n      this.warmupPromise = this.warmupCache();\n    }\n  }\n\n  /**\n   * Get cached data with performance optimizations\n   */\n  async get<T>(key: string, loader: () => Promise<T>, options?: {\n    ttl?: number;\n    enableCompression?: boolean;\n    etag?: string;\n  }): Promise<T> {\n    const startTime = Date.now();\n    const fullKey = this.buildKey(key, options?.etag);\n\n    // Check cache first\n    const cached = this.cache.get(fullKey);\n    if (cached && this.isValid(cached, options?.etag)) {\n      cached.accessCount++;\n      cached.lastAccess = Date.now();\n      \n      if (this.config.enableMetrics) {\n        this.metrics.hits++;\n      }\n\n      // Return compressed or raw data\n      return cached.compressed ? \n        JSON.parse(gunzipSync(new Uint8Array(cached.compressed)).toString()) : \n        cached.data;\n    }\n\n    // Cache miss - load data\n    if (this.config.enableMetrics) {\n      this.metrics.misses++;\n    }\n\n    try {\n      const data = await loader();\n      const loadTime = Date.now() - startTime;\n\n      // Store in cache with optimization\n      await this.set(fullKey, data, {\n        ttl: options?.ttl,\n        enableCompression: options?.enableCompression,\n        etag: options?.etag,\n        loadTime\n      });\n\n      return data;\n    } catch (error) {\n      // If cache has stale data, return it as fallback\n      if (cached) {\n        console.warn('Loader failed, returning stale cache data:', error);\n        return cached.compressed ? \n          JSON.parse(gunzipSync(new Uint8Array(cached.compressed)).toString()) : \n          cached.data;\n      }\n      throw error;\n    }\n  }\n\n  /**\n   * Set cache entry with compression and metrics\n   */\n  private async set<T>(key: string, data: T, options?: {\n    ttl?: number;\n    enableCompression?: boolean;\n    etag?: string;\n    loadTime?: number;\n  }): Promise<void> {\n    const serialized = JSON.stringify(data);\n    const size = Buffer.byteLength(serialized, 'utf8');\n    \n    let compressed: Buffer | undefined;\n    let finalSize = size;\n\n    // Apply compression if enabled and data is large enough\n    const shouldCompress = (options?.enableCompression ?? this.config.enableCompression) && \n                          size > this.config.compressionThreshold;\n\n    if (shouldCompress) {\n      compressed = gzipSync(serialized);\n      finalSize = compressed.length;\n\n      // Update compression metrics\n      if (this.config.enableMetrics) {\n        const ratio = finalSize / size;\n        this.metrics.compressionRatio = \n          (this.metrics.compressionRatio + ratio) / 2;\n      }\n    }\n\n    const entry: CacheEntry<T> = {\n      data: shouldCompress ? undefined as any : data,\n      compressed,\n      timestamp: Date.now(),\n      accessCount: 1,\n      lastAccess: Date.now(),\n      size: finalSize,\n      etag: options?.etag\n    };\n\n    // Set with custom TTL if provided\n    if (options?.ttl) {\n      this.cache.set(key, entry, { ttl: options.ttl });\n    } else {\n      this.cache.set(key, entry);\n    }\n\n    // Update metrics\n    if (this.config.enableMetrics) {\n      this.metrics.totalSize += finalSize;\n      \n      if (options?.loadTime) {\n        this.metrics.averageLoadTime = \n          (this.metrics.averageLoadTime + options.loadTime) / 2;\n      }\n    }\n  }\n\n  /**\n   * Preload content for performance optimization\n   */\n  async preload<T>(key: string, loader: () => Promise<T>, options?: {\n    priority?: 'high' | 'normal' | 'low';\n    ttl?: number;\n  }): Promise<void> {\n    // Don't preload if already cached and valid\n    if (this.cache.has(key)) {\n      const cached = this.cache.get(key);\n      if (cached && this.isValid(cached)) {\n        return;\n      }\n    }\n\n    // Execute preload based on priority\n    const preloadPromise = this.get(key, loader, { ttl: options?.ttl });\n\n    if (options?.priority === 'high') {\n      await preloadPromise;\n    } else {\n      // Low priority - don't block\n      preloadPromise.catch(err => \n        console.warn(`Preload failed for ${key}:`, err)\n      );\n    }\n  }\n\n  /**\n   * Warm up cache with common content\n   */\n  private async warmupCache(): Promise<void> {\n    if (!this.config.warmupUrls) return;\n\n    const warmupPromises = this.config.warmupUrls.map(async (url) => {\n      try {\n        const { fetchWithResilience } = await import('./fetchWithResilience');\n        const response = await fetchWithResilience(url, {\n          method: 'HEAD',\n          cache: 'no-store'\n        });\n        \n        if (response.ok) {\n          // Preload this content\n          const key = this.urlToKey(url);\n          await this.preload(key, async () => {\n            const { fetchWithResilience } = await import('./fetchWithResilience');\n            const r = await fetchWithResilience(url);\n            return r.json();\n          }, {\n            priority: 'normal'\n          });\n        }\n      } catch (error) {\n        console.warn(`Cache warmup failed for ${url}:`, error);\n      }\n    });\n\n    await Promise.allSettled(warmupPromises);\n  }\n\n  /**\n   * Invalidate cache entries\n   */\n  invalidate(pattern?: string | RegExp): number {\n    let count = 0;\n\n    if (!pattern) {\n      // Clear all\n      count = this.cache.size;\n      this.cache.clear();\n      this.resetMetrics();\n      return count;\n    }\n\n    // Pattern-based invalidation\n    const keys = Array.from(this.cache.keys());\n    const isRegex = pattern instanceof RegExp;\n\n    for (const key of keys) {\n      const shouldDelete = isRegex ? \n        pattern.test(key) : \n        key.includes(pattern as string);\n\n      if (shouldDelete) {\n        this.cache.delete(key);\n        count++;\n      }\n    }\n\n    return count;\n  }\n\n  /**\n   * Get cache statistics\n   */\n  getStats(): CacheMetrics & {\n    size: number;\n    hitRate: number;\n    cacheSize: number;\n    oldestEntry?: number;\n    newestEntry?: number;\n  } {\n    const total = this.metrics.hits + this.metrics.misses;\n    const hitRate = total > 0 ? this.metrics.hits / total : 0;\n\n    let oldest: number | undefined;\n    let newest: number | undefined;\n\n    // Calculate age statistics\n    for (const entry of Array.from(this.cache.values())) {\n      if (!oldest || entry.timestamp < oldest) oldest = entry.timestamp;\n      if (!newest || entry.timestamp > newest) newest = entry.timestamp;\n    }\n\n    return {\n      ...this.metrics,\n      size: this.cache.size,\n      hitRate: Math.round(hitRate * 100) / 100,\n      cacheSize: this.cache.calculatedSize || 0,\n      oldestEntry: oldest,\n      newestEntry: newest\n    };\n  }\n\n  /**\n   * Optimize cache performance\n   */\n  optimize(): {\n    removedStale: number;\n    compressedEntries: number;\n    freedSpace: number;\n  } {\n    let removedStale = 0;\n    let compressedEntries = 0;\n    let freedSpace = 0;\n\n    const now = Date.now();\n    const staleThreshold = 30 * 60 * 1000; // 30 minutes\n\n    for (const [key, entry] of Array.from(this.cache.entries())) {\n      // Remove stale entries that haven't been accessed recently\n      if (now - entry.lastAccess > staleThreshold && entry.accessCount < 2) {\n        freedSpace += entry.size;\n        this.cache.delete(key);\n        removedStale++;\n        continue;\n      }\n\n      // Compress frequently accessed large entries\n      if (!entry.compressed && \n          entry.size > this.config.compressionThreshold && \n          entry.accessCount > 5) {\n        try {\n          const serialized = JSON.stringify(entry.data);\n          const compressed = gzipSync(serialized);\n          \n          if (compressed.length < entry.size * 0.8) { // Only if significant savings\n            entry.compressed = compressed;\n            entry.data = undefined as any;\n            freedSpace += entry.size - compressed.length;\n            entry.size = compressed.length;\n            compressedEntries++;\n          }\n        } catch (error) {\n          console.warn(`Compression failed for ${key}:`, error);\n        }\n      }\n    }\n\n    return { removedStale, compressedEntries, freedSpace };\n  }\n\n  /**\n   * Apply cache configuration based on NODE_ENV\n   */\n  applyEnvironmentConfig(): void {\n    const isProd = process.env.NODE_ENV === 'production';\n    \n    const config = {\n      ttl: isProd ? 60 * 60 * 1000 : 60 * 1000, // 1 hour in prod, 1 minute in dev\n      enableCompression: isProd,\n      maxSize: isProd ? 100 * 1024 * 1024 : 10 * 1024 * 1024 // 100MB in prod, 10MB in dev\n    };\n\n    this.config = { ...this.config, ...config };\n    this.cache.ttl = config.ttl;\n  }\n\n  // Private helper methods\n\n  private buildKey(key: string, etag?: string): string {\n    return etag ? `${key}:${etag}` : key;\n  }\n\n  private isValid(entry: CacheEntry<any>, etag?: string): boolean {\n    // Check TTL\n    if (Date.now() - entry.timestamp > this.config.ttl) {\n      return false;\n    }\n\n    // Check ETag if provided\n    if (etag && entry.etag && entry.etag !== etag) {\n      return false;\n    }\n\n    return true;\n  }\n\n  private urlToKey(url: string): string {\n    return url.replace(/[^a-zA-Z0-9]/g, '_');\n  }\n\n  private resetMetrics(): void {\n    this.metrics = {\n      hits: 0,\n      misses: 0,\n      evictions: 0,\n      compressionRatio: 0,\n      averageLoadTime: 0,\n      totalSize: 0\n    };\n  }\n}\n\n// Global cache instance\nexport const globalCache = new PerformanceCacheManager({\n  maxSize: 50 * 1024 * 1024, // 50MB\n  ttl: 10 * 60 * 1000, // 10 minutes\n  enableCompression: true,\n  compressionThreshold: 1024,\n  enableMetrics: true\n});\n\n// Helper function to create environment-specific cache keys\nexport function createCacheKey(type: string, env: AppEnv, additionalParams?: Record<string, string>): string {\n  const params = additionalParams ? \n    Object.entries(additionalParams).map(([k, v]) => `${k}:${v}`).join('|') : \n    '';\n  return params ? `${type}:${env}:${params}` : `${type}:${env}`;\n}",
  "config.ts": "import themes from \"daisyui/src/theming/themes\";\nimport { ConfigProps } from \"./types/config\";\nimport { resolveEnv } from \"@/src/lib/data/env\";\n\n// Build-time synchronous snapshot of config.json mapped to legacy ConfigProps\n// Note: This file is imported client and server. Do not leak secrets.\n// We keep the same shape expected by existing imports.\n\nfunction snapshot(): ConfigProps {\n  // Since getConfigData is async fs read, we can't await here synchronously.\n  // Instead, derive from NODE_ENV with safe defaults. Pages that need richer\n  // config should use the data loader directly server-side.\n  const isProd = process.env.NODE_ENV === \"production\";\n  return {\n    appName: \"Old Crown Girton\",\n    appDescription:\n      \"Historic thatched pub in Girton serving authentic Nepalese cuisine and British pub classics. Voted #1 restaurant in Girton on TripAdvisor.\",\n    domainName: \"oldcrowngirton.com\",\n    crisp: { id: \"\", onlyShowOnRoutes: [\"/\"] },\n    stripe: {\n      plans: [\n        {\n          priceId: isProd ? \"price_live_stub\" : \"price_dev_stub\",\n          name: \"Starter\",\n          description: \"Legacy pricing placeholder\",\n          price: 99,\n          priceAnchor: 149,\n          features: [{ name: \"Legacy\" }],\n        },\n      ],\n    },\n    aws: { bucket: undefined, bucketUrl: undefined, cdn: undefined },\n    mailgun: {\n      subdomain: \"mg\",\n      fromNoReply: `Old Crown <noreply@mg.oldcrowngirton.com>`,\n      fromAdmin: `Old Crown <info@mg.oldcrowngirton.com>`,\n      supportEmail: \"oldcrown@lapeninns.com\",\n      forwardRepliesTo: \"oldcrown@lapeninns.com\",\n    },\n    colors: { theme: \"light\", main: themes[\"light\"][\"primary\"] },\n    auth: { loginUrl: \"/signin\", callbackUrl: \"/dashboard\" },\n  };\n}\n\nconst config = snapshot();\nexport default config;\n"
}